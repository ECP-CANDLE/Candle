<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>parsing_utils &mdash; CANDLE  documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> CANDLE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../readme.html">What is CANDLE?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../candle_lib.html">CANDLE Library API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shared_installation.html">CANDLE Shared Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">How to Contribute</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CANDLE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Module code</a> &raquo;</li>
      <li>parsing_utils</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for parsing_utils</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">absolute_import</span>

<span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">helper_utils</span> <span class="k">as</span> <span class="nn">hutils</span>
<span class="kn">from</span> <span class="nn">file_utils</span> <span class="kn">import</span> <span class="n">directory_from_parameters</span>

<span class="c1"># Seed for random generation -- default value</span>
<span class="n">DEFAULT_SEED</span> <span class="o">=</span> <span class="mi">7102</span>
<span class="n">DEFAULT_TIMEOUT</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># no timeout</span>
<span class="n">DEFAULT_DATATYPE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>

<span class="n">basic_conf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;config_file&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;specify model configuration file&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;data_type&#39;</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;f16&#39;</span><span class="p">,</span> <span class="s1">&#39;f32&#39;</span><span class="p">,</span> <span class="s1">&#39;f64&#39;</span><span class="p">],</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;default floating point.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;rng_seed&#39;</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;random number generator seed.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;train_bool&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;train model.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;eval_bool&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;evaluate model (use it for inference).&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;timeout&#39;</span><span class="p">,</span>
        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;store&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;seconds allowed to train model (default: no timeout).&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;gpus&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nargs&#39;</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;set IDs of GPUs to use.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;profiling&#39;</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;p&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Turn profiling on or off.&#39;</span><span class="p">},</span>
<span class="p">]</span>

<span class="n">input_output_conf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;save_path&#39;</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;s&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;file path to save model snapshots.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;model_name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;specify model name to use when building filenames for saving.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;home_dir&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;set home directory.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;train_data&#39;</span><span class="p">,</span>
        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;store&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;training data filename.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;test_data&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;store&#39;</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;testing data filename.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;output_dir&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;output directory.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;data_url&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;set data source url.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;experiment_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;EXP000&#39;</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;set the experiment unique identifier.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;run_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;RUN000&#39;</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;set the run unique identifier.&#39;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">logging_conf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;verbose&#39;</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;increase output verbosity.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;logfile&#39;</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;log file&#39;</span><span class="p">},</span>
<span class="p">]</span>

<span class="n">data_preprocess_conf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;scaling&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;minabs&#39;</span><span class="p">,</span> <span class="s1">&#39;minmax&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">],</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s2">&quot;type of feature scaling; &#39;minabs&#39;: to [-1,1]; &#39;minmax&#39;: to [0,1], &#39;std&#39;: standard unit normalization; &#39;none&#39;: no normalization.&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;shuffle&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;randomly shuffle data set (produces different training and testing partitions each run depending on the seed)&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;feature_subsample&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;number of features to randomly sample from each category (cellline expression, drug descriptors, etc), 0 means using all features&#39;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">model_conf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;dense&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nargs&#39;</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;number of units in fully connected layers in an integer array.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;conv&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nargs&#39;</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;integer array describing convolution layers: conv1_filters, conv1_filter_len, conv1_stride, conv2_filters, conv2_filter_len, conv2_stride ....&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;locally_connected&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;use locally connected layers instead of convolution layers.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;activation&#39;</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;keras activation function to use in inner layers: relu, tanh, sigmoid...&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;out_activation&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;keras activation function to use in out layer: softmax, linear, ...&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;lstm_size&#39;</span><span class="p">,</span>
        <span class="s1">&#39;nargs&#39;</span><span class="p">:</span> <span class="s1">&#39;+&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;integer array describing size of LSTM internal state per layer.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;recurrent_dropout&#39;</span><span class="p">,</span>
        <span class="s1">&#39;action&#39;</span><span class="p">:</span> <span class="s1">&#39;store&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio of recurrent dropout.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;dropout&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;ratio of dropout used in fully connected layers.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;pool&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;pooling layer length.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;batch_normalization&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;use batch normalization.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;keras loss function to use: mse, ...&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;optimizer&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;keras optimizer to use: sgd, rmsprop, ...&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;metrics&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;metrics to evaluate performance: accuracy, ...&#39;</span><span class="p">},</span>
<span class="p">]</span>

<span class="n">training_conf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;epochs&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;e&#39;</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;number of training epochs.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;batch_size&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;batch size.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;learning_rate&#39;</span><span class="p">,</span>
        <span class="s1">&#39;abv&#39;</span><span class="p">:</span> <span class="s1">&#39;lr&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;overrides the learning rate for training.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;early_stop&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;activates keras callback for early stopping of training in function of the monitored variable specified.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;momentum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;overrides the momentum to use in the SGD optimizer when training.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;initialization&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;constant&#39;</span><span class="p">,</span> <span class="s1">&#39;uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;normal&#39;</span><span class="p">,</span> <span class="s1">&#39;glorot_uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;glorot_normal&#39;</span><span class="p">,</span> <span class="s1">&#39;lecun_uniform&#39;</span><span class="p">,</span> <span class="s1">&#39;he_normal&#39;</span><span class="p">],</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s2">&quot;type of weight initialization; &#39;constant&#39;: to 0; &#39;uniform&#39;: to [-0.05,0.05], &#39;normal&#39;: mean 0, stddev 0.05; &#39;glorot_uniform&#39;: [-lim,lim] with lim = sqrt(6/(fan_in+fan_out)); &#39;lecun_uniform&#39; : [-lim,lim] with lim = sqrt(3/fan_in); &#39;he_normal&#39; : mean 0, stddev sqrt(2/fan_in).&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;val_split&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;fraction of data to use in validation.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;train_steps&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;overrides the number of training batches per epoch if set to nonzero.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;val_steps&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;overrides the number of validation batches per epoch if set to nonzero.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;test_steps&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;overrides the number of test batches per epoch if set to nonzero.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;train_samples&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;overrides the number of training samples if set to nonzero.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;val_samples&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;overrides the number of validation samples if set to nonzero.&#39;</span><span class="p">},</span>
<span class="p">]</span>


<span class="n">cyclic_learning_conf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;clr_flag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;CLR flag (boolean).&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;clr_mode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;trng1&#39;</span><span class="p">,</span> <span class="s1">&#39;trng2&#39;</span><span class="p">,</span> <span class="s1">&#39;exp&#39;</span><span class="p">],</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;CLR mode (default: trng1).&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;clr_base_lr&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Base lr for cycle lr.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;clr_max_lr&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Max lr for cycle lr.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;clr_gamma&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Gamma parameter for learning cycle LR.&#39;</span><span class="p">}</span>
<span class="p">]</span>

<span class="n">ckpt_conf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_restart_mode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span>
        <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;off&#39;</span><span class="p">,</span> <span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="s1">&#39;required&#39;</span><span class="p">],</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s2">&quot;Mode to restart from a saved checkpoint file, choices are &#39;off&#39;, &#39;auto&#39;, &#39;required&#39;.&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_checksum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Checksum the restart file after read+write.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_skip_epochs&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Number of epochs to skip before saving epochs.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_directory&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;./save&#39;</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Base directory in which to save checkpoints.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_save_best&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Toggle saving best model.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_save_best_metric&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;val_loss&#39;</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Metric for determining when to save best model.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_save_weights_only&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="n">hutils</span><span class="o">.</span><span class="n">str2bool</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Toggle saving only weights (not optimizer) (NYI).&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_save_interval&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Interval to save checkpoints.&#39;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_keep_mode&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="s1">&#39;linear&#39;</span><span class="p">,</span>
        <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;exponential&#39;</span><span class="p">],</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s2">&quot;Checkpoint saving mode, choices are &#39;linear&#39; or &#39;exponential&#39;.&quot;</span><span class="p">},</span>
    <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;ckpt_keep_limit&#39;</span><span class="p">,</span>
        <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="mi">1000000</span><span class="p">,</span>
        <span class="s1">&#39;help&#39;</span><span class="p">:</span> <span class="s1">&#39;Limit checkpoints to keep.&#39;</span><span class="p">},</span>
<span class="p">]</span>


<span class="n">registered_conf</span> <span class="o">=</span> <span class="p">[</span><span class="n">basic_conf</span><span class="p">,</span> <span class="n">input_output_conf</span><span class="p">,</span> <span class="n">logging_conf</span><span class="p">,</span> <span class="n">data_preprocess_conf</span><span class="p">,</span> <span class="n">model_conf</span><span class="p">,</span> <span class="n">training_conf</span><span class="p">,</span> <span class="n">cyclic_learning_conf</span><span class="p">,</span> <span class="n">ckpt_conf</span><span class="p">]</span>


<div class="viewcode-block" id="extract_keywords"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.extract_keywords">[docs]</a><span class="k">def</span> <span class="nf">extract_keywords</span><span class="p">(</span><span class="n">lst_dict</span><span class="p">,</span> <span class="n">kw</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extract the value associated to a specific keyword in a list of dictionaries. Returns the list of values extracted from the keywords.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       lst_dict : python list of dictionaries</span>
<span class="sd">          list to extract keywords from</span>
<span class="sd">       kw : string</span>
<span class="sd">          keyword to extract from dictionary</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">di</span><span class="p">[</span><span class="n">kw</span><span class="p">]</span> <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">lst_dict</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">lst</span></div>


<span class="c1"># Extract list of parameters in registered configuration</span>
<span class="n">PARAMETERS_CANDLE</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">registered_conf</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">extract_keywords</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)]</span>

<span class="n">CONFLICT_LIST</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s1">&#39;clr_flag&#39;</span><span class="p">,</span> <span class="s1">&#39;warmup_lr&#39;</span><span class="p">],</span>
    <span class="p">[</span><span class="s1">&#39;clr_flag&#39;</span><span class="p">,</span> <span class="s1">&#39;reduce_lr&#39;</span><span class="p">]</span>
<span class="p">]</span>


<div class="viewcode-block" id="check_flag_conflicts"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.check_flag_conflicts">[docs]</a><span class="k">def</span> <span class="nf">check_flag_conflicts</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Check if parameters that must be exclusive are used in conjunction.</span>
<span class="sd">        The check is made against CONFLICT_LIST, a global list that</span>
<span class="sd">        describes parameter pairs that should be exclusive.</span>
<span class="sd">        Raises an exception if pairs of parameters in CONFLICT_LIST are</span>
<span class="sd">        specified simulataneously.</span>

<span class="sd">       Parameters</span>
<span class="sd">       ----------</span>
<span class="sd">       params : python dictionary</span>
<span class="sd">          list to extract keywords from</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="c1"># check for conflicts</span>
    <span class="c1"># conflict_flag = False</span>
    <span class="c1"># loop over each set of mutually exclusive flags</span>
    <span class="c1"># if any set conflicts exit program</span>
    <span class="k">for</span> <span class="n">flag_list</span> <span class="ow">in</span> <span class="n">CONFLICT_LIST</span><span class="p">:</span>
        <span class="n">flag_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">flag_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">key_set</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">flag_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">flag_count</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s1">&#39;ERROR ! Conflict in flag specification. These flags should not be used together: &#39;</span>
                <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">flag_list</span><span class="p">))</span> <span class="o">+</span> <span class="s1">&#39;... Exiting&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="ArgumentStruct"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.ArgumentStruct">[docs]</a><span class="k">class</span> <span class="nc">ArgumentStruct</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Class that converts a python dictionary into an object with</span>
<span class="sd">       named entries given by the dictionary keys.</span>
<span class="sd">       This structure simplifies the calling convention for accessing</span>
<span class="sd">       the dictionary values (corresponding to problem parameters).</span>
<span class="sd">       After the object instantiation both modes of access (dictionary</span>
<span class="sd">       or object entries) can be used.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">entries</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span></div>


<div class="viewcode-block" id="ListOfListsAction"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.ListOfListsAction">[docs]</a><span class="k">class</span> <span class="nc">ListOfListsAction</span><span class="p">(</span><span class="n">argparse</span><span class="o">.</span><span class="n">Action</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class extends the argparse.Action class by instantiating</span>
<span class="sd">        an argparser that constructs a list-of-lists from an input</span>
<span class="sd">        (command-line option or argument) given as a string.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">option_strings</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Initialize a ListOfListsAction object. If no type is specified,</span>
<span class="sd">           an integer is assumed by default as the type for the elements</span>
<span class="sd">           of the list-of-lists.</span>

<span class="sd">           Parameters</span>
<span class="sd">           ----------</span>
<span class="sd">           option_strings : string</span>
<span class="sd">               String to parse</span>
<span class="sd">           dest : object</span>
<span class="sd">               Object to store the output (in this case the parsed list-of-lists).</span>
<span class="sd">           type : data type</span>
<span class="sd">               Data type to decode the elements of the lists.</span>
<span class="sd">               Defaults to np.int32.</span>
<span class="sd">           kwargs : object</span>
<span class="sd">               Python object containing other argparse.Action parameters.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">ListOfListsAction</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">option_strings</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="nb">type</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int32</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">option_string</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;This function overrides the __call__ method of the base</span>
<span class="sd">           argparse.Action class.</span>

<span class="sd">           This function implements the action of the ListOfListAction</span>
<span class="sd">           class by parsing an input string (command-line option or argument)</span>
<span class="sd">           and maping it into a list-of-lists. The resulting list-of-lists is</span>
<span class="sd">           added to the namespace of parsed arguments. The parsing assumes that</span>
<span class="sd">           the separator between lists is a colon &#39;:&#39; and the separator inside</span>
<span class="sd">           the list is a comma &#39;,&#39;. The values of the list are casted to the</span>
<span class="sd">           type specified at the object initialization.</span>

<span class="sd">           Parameters</span>
<span class="sd">           ----------</span>
<span class="sd">           parser : ArgumentParser object</span>
<span class="sd">               Object that contains this action</span>
<span class="sd">           namespace : Namespace object</span>
<span class="sd">               Namespace object that will be returned by the parse_args()</span>
<span class="sd">               function.</span>
<span class="sd">           values : string</span>
<span class="sd">               The associated command-line arguments converted to string type</span>
<span class="sd">               (i.e. input).</span>
<span class="sd">           option_string : string</span>
<span class="sd">               The option string that was used to invoke this action. (optional)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">decoded_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">removed1</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">removed2</span> <span class="o">=</span> <span class="n">removed1</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="n">out_list</span> <span class="o">=</span> <span class="n">removed2</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">out_list</span><span class="p">:</span>
            <span class="n">in_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">elem</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">elem</span><span class="p">:</span>
                <span class="n">in_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">el</span><span class="p">))</span>
            <span class="n">decoded_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">in_list</span><span class="p">)</span>

        <span class="nb">setattr</span><span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="n">decoded_list</span><span class="p">)</span></div>


<div class="viewcode-block" id="check_file_parameters_exists"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.check_file_parameters_exists">[docs]</a><span class="k">def</span> <span class="nf">check_file_parameters_exists</span><span class="p">(</span><span class="n">params_parser</span><span class="p">,</span> <span class="n">params_benchmark</span><span class="p">,</span> <span class="n">params_file</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Functionality to verify that the parameters defined in the configuraion file are recognizable by the command line parser (i.e. no uknown keywords are used in the configuration file).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    params_parser : python dictionary</span>
<span class="sd">        Includes parameters set via the command line.</span>
<span class="sd">    params_benchmark : python list</span>
<span class="sd">        Includes additional parameters defined in the benchmark.</span>
<span class="sd">    params_file : python dictionary</span>
<span class="sd">        Includes parameters read from the configuration file.</span>

<span class="sd">        Global:</span>
<span class="sd">        PARAMETERS_CANDLE : python list</span>
<span class="sd">            Includes all the core keywords that are specified in CANDLE.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get keywords from arguments coming via command line (and CANDLE supervisor)</span>
    <span class="n">args_dict</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">params_parser</span><span class="p">)</span>
    <span class="n">args_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">args_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="c1"># Get keywords from benchmark definition</span>
    <span class="n">bmk_keys</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">params_benchmark</span><span class="p">:</span>
        <span class="n">bmk_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])</span>
    <span class="n">bmk_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">bmk_keys</span><span class="p">)</span>
    <span class="c1"># Get core CANDLE keywords</span>
    <span class="n">candle_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">PARAMETERS_CANDLE</span><span class="p">)</span>
    <span class="c1"># Consolidate keywords from CANDLE core, command line, CANDLE supervisor and benchmark</span>
    <span class="n">candle_set</span> <span class="o">=</span> <span class="n">candle_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">args_set</span><span class="p">)</span>
    <span class="n">candle_set</span> <span class="o">=</span> <span class="n">candle_set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">bmk_set</span><span class="p">)</span>
    <span class="c1"># Get keywords used in config_file</span>
    <span class="n">file_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">params_file</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="c1"># Compute keywords that come from the config_file that are not in the CANDLE specs</span>
    <span class="n">diff_set</span> <span class="o">=</span> <span class="n">file_set</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">candle_set</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">diff_set</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="s1">&#39;These keywords used in the configuration file are not defined in CANDLE: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">diff_set</span><span class="p">))</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="ne">RuntimeWarning</span><span class="p">)</span></div>


<div class="viewcode-block" id="finalize_parameters"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.finalize_parameters">[docs]</a><span class="k">def</span> <span class="nf">finalize_parameters</span><span class="p">(</span><span class="n">bmk</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Utility to parse parameters in common as well as parameters</span>
<span class="sd">        particular to each benchmark.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        bmk : benchmark object</span>
<span class="sd">            Object that has benchmark filepaths and specifications</span>

<span class="sd">        Return</span>
<span class="sd">        ----------</span>
<span class="sd">        gParameters : python dictionary</span>
<span class="sd">            Dictionary with all the parameters necessary to run the benchmark.</span>
<span class="sd">            Command line overwrites config file specifications</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Parse common and benchmark parameters</span>
    <span class="n">bmk</span><span class="o">.</span><span class="n">parse_parameters</span><span class="p">()</span>

    <span class="c1"># print(&#39;Args:&#39;, args)</span>
    <span class="c1"># Get parameters from configuration file</span>
    <span class="c1"># Reads parameter subset, just checking if a config_file has been set</span>
    <span class="c1"># by comand line (the parse_known_args() function allows a partial</span>
    <span class="c1"># parsing)</span>
    <span class="n">aux</span> <span class="o">=</span> <span class="n">bmk</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_known_args</span><span class="p">()</span>
    <span class="k">try</span><span class="p">:</span>  <span class="c1"># Try to get the &#39;config_file&#39; option</span>
        <span class="n">conffile_txt</span> <span class="o">=</span> <span class="n">aux</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">config_file</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># The &#39;config_file&#39; option was not set by command-line</span>
        <span class="n">conffile</span> <span class="o">=</span> <span class="n">bmk</span><span class="o">.</span><span class="n">conffile</span>  <span class="c1"># use default file</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># a &#39;config_file&#39; has been set --&gt; use this file</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isabs</span><span class="p">(</span><span class="n">conffile_txt</span><span class="p">):</span>
            <span class="n">conffile</span> <span class="o">=</span> <span class="n">conffile_txt</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">conffile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bmk</span><span class="o">.</span><span class="n">file_path</span><span class="p">,</span> <span class="n">conffile_txt</span><span class="p">)</span>

    <span class="c1"># print(&quot;Configuration file: &quot;, conffile)</span>
    <span class="n">fileParameters</span> <span class="o">=</span> <span class="n">bmk</span><span class="o">.</span><span class="n">read_config_file</span><span class="p">(</span><span class="n">conffile</span><span class="p">)</span>  <span class="c1"># aux.config_file)#args.config_file)</span>
    <span class="c1"># Get command-line parameters</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">bmk</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="c1"># print (&#39;Params:&#39;, fileParameters)</span>
    <span class="c1"># Check keywords from file against CANDLE common and module definitions</span>
    <span class="n">bmk_dict</span> <span class="o">=</span> <span class="n">bmk</span><span class="o">.</span><span class="n">additional_definitions</span>
    <span class="n">check_file_parameters_exists</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">bmk_dict</span><span class="p">,</span> <span class="n">fileParameters</span><span class="p">)</span>
    <span class="c1"># Consolidate parameter set. Command-line parameters overwrite file configuration</span>
    <span class="n">gParameters</span> <span class="o">=</span> <span class="n">args_overwrite_config</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">fileParameters</span><span class="p">)</span>
    <span class="c1"># Check that required set of parameters has been defined</span>
    <span class="n">bmk</span><span class="o">.</span><span class="n">check_required_exists</span><span class="p">(</span><span class="n">gParameters</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Params:&#39;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">gParameters</span><span class="p">)</span>
    <span class="c1"># Check that no keywords conflict</span>
    <span class="n">check_flag_conflicts</span><span class="p">(</span><span class="n">gParameters</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">gParameters</span></div>


<div class="viewcode-block" id="args_overwrite_config"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.args_overwrite_config">[docs]</a><span class="k">def</span> <span class="nf">args_overwrite_config</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Overwrite configuration parameters with</span>
<span class="sd">        parameters specified via command-line.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args : ArgumentParser object</span>
<span class="sd">            Parameters specified via command-line</span>
<span class="sd">        config : python dictionary</span>
<span class="sd">            Parameters read from configuration file</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">params</span> <span class="o">=</span> <span class="n">config</span>

    <span class="n">args_dict</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">args_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="c1"># try casting here</span>
        <span class="n">params</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">args_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">if</span> <span class="s1">&#39;data_type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_DATATYPE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="nb">set</span><span class="p">([</span><span class="s1">&#39;f16&#39;</span><span class="p">,</span> <span class="s1">&#39;f32&#39;</span><span class="p">,</span> <span class="s1">&#39;f64&#39;</span><span class="p">]):</span>
            <span class="n">params</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_choice</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;data_type&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="s1">&#39;output_dir&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;output_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">directory_from_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;output_dir&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">directory_from_parameters</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;output_dir&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="s1">&#39;rng_seed&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;rng_seed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_SEED</span>

    <span class="k">if</span> <span class="s1">&#39;timeout&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
        <span class="n">params</span><span class="p">[</span><span class="s1">&#39;timeout&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">DEFAULT_TIMEOUT</span>

    <span class="k">return</span> <span class="n">params</span></div>


<div class="viewcode-block" id="get_choice"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.get_choice">[docs]</a><span class="k">def</span> <span class="nf">get_choice</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Maps name string to the right type of argument</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mapping</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># dtype</span>
    <span class="n">mapping</span><span class="p">[</span><span class="s1">&#39;f16&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float16</span>
    <span class="n">mapping</span><span class="p">[</span><span class="s1">&#39;f32&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span>
    <span class="n">mapping</span><span class="p">[</span><span class="s1">&#39;f64&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span>

    <span class="n">mapped</span> <span class="o">=</span> <span class="n">mapping</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">mapped</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;No mapping found for &quot;</span><span class="si">{}</span><span class="s1">&quot;&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">mapped</span></div>


<div class="viewcode-block" id="parse_from_dictlist"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.parse_from_dictlist">[docs]</a><span class="k">def</span> <span class="nf">parse_from_dictlist</span><span class="p">(</span><span class="n">dictlist</span><span class="p">,</span> <span class="n">parser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Functionality to parse options.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pardict : python list of dictionaries</span>
<span class="sd">            Specification of parameters</span>
<span class="sd">        parser : ArgumentParser object</span>
<span class="sd">            Current parser</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">dictlist</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># print(d[&#39;name&#39;], &#39;type is &#39;, d[&#39;type&#39;])</span>

        <span class="k">if</span> <span class="s1">&#39;default&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">SUPPRESS</span>

        <span class="k">if</span> <span class="s1">&#39;help&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="s1">&#39;abv&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="s1">&#39;action&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>  <span class="c1"># Actions</span>
            <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;list-of-lists&#39;</span><span class="p">:</span>  <span class="c1"># Non standard. Specific functionallity has been added</span>
                <span class="n">d</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ListOfListsAction</span>
                <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">dest</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">action</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">dest</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">action</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;store_true&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;store_false&#39;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;The usage of store_true or store_false cannot be undone in the command line. Use type=str2bool instead.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">action</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">action</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;action&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Non actions</span>
            <span class="k">if</span> <span class="s1">&#39;nargs&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>  <span class="c1"># variable parameters</span>
                <span class="k">if</span> <span class="s1">&#39;choices&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>  <span class="c1"># choices with variable parameters</span>
                    <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">nargs</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;nargs&#39;</span><span class="p">],</span> <span class="n">choices</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">nargs</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;nargs&#39;</span><span class="p">],</span> <span class="n">choices</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Variable parameters (free, no limited choices)</span>
                    <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">nargs</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;nargs&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">nargs</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;nargs&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
            <span class="k">elif</span> <span class="s1">&#39;choices&#39;</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>  <span class="c1"># Select from choice (fixed number of parameters)</span>
                <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">choices</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="n">choices</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Non an action, one parameter, no choices</span>
                <span class="c1"># print(&#39;Adding &#39;, d[&#39;name&#39;], &#39; to parser&#39;)</span>
                <span class="k">if</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;abv&#39;</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">],</span> <span class="n">default</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">],</span> <span class="n">help</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;help&#39;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">parser</span></div>


<div class="viewcode-block" id="parse_common"><a class="viewcode-back" href="../candle_lib/parsing_utils.html#parsing_utils.parse_common">[docs]</a><span class="k">def</span> <span class="nf">parse_common</span><span class="p">(</span><span class="n">parser</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Functionality to parse options.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parser : ArgumentParser object</span>
<span class="sd">            Current parser</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">for</span> <span class="n">lst</span> <span class="ow">in</span> <span class="n">registered_conf</span><span class="p">:</span>
        <span class="n">parser</span> <span class="o">=</span> <span class="n">parse_from_dictlist</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">parser</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">parser</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, ANL.gov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>