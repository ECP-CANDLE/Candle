<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>candle &mdash; ECP-CANDLE</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CANDLE Shared Installation" href="../shared_installation.html" />
    <link rel="prev" title="Run Modes: Summit" href="../tutorials/examples/run-summit/README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> CANDLE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">What is CANDLE?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#"><code class="docutils literal notranslate"><span class="pre">candle</span></code></a><ul>
<li class="toctree-l2"><a class="reference internal" href="#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#candle.generate_cross_validation_partition"><code class="docutils literal notranslate"><span class="pre">generate_cross_validation_partition()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.quantile_normalization"><code class="docutils literal notranslate"><span class="pre">quantile_normalization()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.load_csv_data"><code class="docutils literal notranslate"><span class="pre">load_csv_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.load_Xy_data_noheader"><code class="docutils literal notranslate"><span class="pre">load_Xy_data_noheader()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.load_Xy_one_hot_data2"><code class="docutils literal notranslate"><span class="pre">load_Xy_one_hot_data2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.select_decorrelated_features"><code class="docutils literal notranslate"><span class="pre">select_decorrelated_features()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.select_features_by_missing_values"><code class="docutils literal notranslate"><span class="pre">select_features_by_missing_values()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.select_features_by_variation"><code class="docutils literal notranslate"><span class="pre">select_features_by_variation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.get_file"><code class="docutils literal notranslate"><span class="pre">get_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.validate_file"><code class="docutils literal notranslate"><span class="pre">validate_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.fetch_file"><code class="docutils literal notranslate"><span class="pre">fetch_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.keras_default_config"><code class="docutils literal notranslate"><span class="pre">keras_default_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.set_up_logger"><code class="docutils literal notranslate"><span class="pre">set_up_logger()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.str2bool"><code class="docutils literal notranslate"><span class="pre">str2bool()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.verify_path"><code class="docutils literal notranslate"><span class="pre">verify_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.add_cluster_noise"><code class="docutils literal notranslate"><span class="pre">add_cluster_noise()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.add_column_noise"><code class="docutils literal notranslate"><span class="pre">add_column_noise()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.add_gaussian_noise"><code class="docutils literal notranslate"><span class="pre">add_gaussian_noise()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.add_noise"><code class="docutils literal notranslate"><span class="pre">add_noise()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.label_flip"><code class="docutils literal notranslate"><span class="pre">label_flip()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.label_flip_correlated"><code class="docutils literal notranslate"><span class="pre">label_flip_correlated()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.combat_batch_effect_removal"><code class="docutils literal notranslate"><span class="pre">combat_batch_effect_removal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.coxen_multi_drug_gene_selection"><code class="docutils literal notranslate"><span class="pre">coxen_multi_drug_gene_selection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.coxen_single_drug_gene_selection"><code class="docutils literal notranslate"><span class="pre">coxen_single_drug_gene_selection()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.generate_gene_set_data"><code class="docutils literal notranslate"><span class="pre">generate_gene_set_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.check_flag_conflicts"><code class="docutils literal notranslate"><span class="pre">check_flag_conflicts()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.finalize_parameters"><code class="docutils literal notranslate"><span class="pre">finalize_parameters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.parse_from_dictlist"><code class="docutils literal notranslate"><span class="pre">parse_from_dictlist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.compute_empirical_calibration_interpolation"><code class="docutils literal notranslate"><span class="pre">compute_empirical_calibration_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.compute_statistics_heteroscedastic"><code class="docutils literal notranslate"><span class="pre">compute_statistics_heteroscedastic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.compute_statistics_homoscedastic"><code class="docutils literal notranslate"><span class="pre">compute_statistics_homoscedastic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.compute_statistics_homoscedastic_summary"><code class="docutils literal notranslate"><span class="pre">compute_statistics_homoscedastic_summary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.compute_statistics_quantile"><code class="docutils literal notranslate"><span class="pre">compute_statistics_quantile()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.generate_index_distribution"><code class="docutils literal notranslate"><span class="pre">generate_index_distribution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.split_data_for_empirical_calibration"><code class="docutils literal notranslate"><span class="pre">split_data_for_empirical_calibration()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_2d_density_sigma_vs_error"><code class="docutils literal notranslate"><span class="pre">plot_2d_density_sigma_vs_error()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_array"><code class="docutils literal notranslate"><span class="pre">plot_array()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_calibrated_std"><code class="docutils literal notranslate"><span class="pre">plot_calibrated_std()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_calibration_interpolation"><code class="docutils literal notranslate"><span class="pre">plot_calibration_interpolation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_contamination"><code class="docutils literal notranslate"><span class="pre">plot_contamination()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_decile_predictions"><code class="docutils literal notranslate"><span class="pre">plot_decile_predictions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_density_observed_vs_predicted"><code class="docutils literal notranslate"><span class="pre">plot_density_observed_vs_predicted()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_histogram_error_per_sigma"><code class="docutils literal notranslate"><span class="pre">plot_histogram_error_per_sigma()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_history"><code class="docutils literal notranslate"><span class="pre">plot_history()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_scatter"><code class="docutils literal notranslate"><span class="pre">plot_scatter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.clr_callback"><code class="docutils literal notranslate"><span class="pre">clr_callback()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.clr_check_args"><code class="docutils literal notranslate"><span class="pre">clr_check_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.clr_set_args"><code class="docutils literal notranslate"><span class="pre">clr_set_args()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.build_initializer"><code class="docutils literal notranslate"><span class="pre">build_initializer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.build_optimizer"><code class="docutils literal notranslate"><span class="pre">build_optimizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.compute_trainable_params"><code class="docutils literal notranslate"><span class="pre">compute_trainable_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.get_function"><code class="docutils literal notranslate"><span class="pre">get_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.mae"><code class="docutils literal notranslate"><span class="pre">mae()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.mse"><code class="docutils literal notranslate"><span class="pre">mse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.r2"><code class="docutils literal notranslate"><span class="pre">r2()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.register_permanent_dropout"><code class="docutils literal notranslate"><span class="pre">register_permanent_dropout()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.set_parallelism_threads"><code class="docutils literal notranslate"><span class="pre">set_parallelism_threads()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.set_seed"><code class="docutils literal notranslate"><span class="pre">set_seed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.abstention_acc_class_i_metric"><code class="docutils literal notranslate"><span class="pre">abstention_acc_class_i_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.abstention_acc_metric"><code class="docutils literal notranslate"><span class="pre">abstention_acc_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.abstention_class_i_metric"><code class="docutils literal notranslate"><span class="pre">abstention_class_i_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.abstention_loss"><code class="docutils literal notranslate"><span class="pre">abstention_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.abstention_metric"><code class="docutils literal notranslate"><span class="pre">abstention_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.acc_class_i_metric"><code class="docutils literal notranslate"><span class="pre">acc_class_i_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.add_index_to_output"><code class="docutils literal notranslate"><span class="pre">add_index_to_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.add_model_output"><code class="docutils literal notranslate"><span class="pre">add_model_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.contamination_loss"><code class="docutils literal notranslate"><span class="pre">contamination_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.heteroscedastic_loss"><code class="docutils literal notranslate"><span class="pre">heteroscedastic_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.mae_contamination_metric"><code class="docutils literal notranslate"><span class="pre">mae_contamination_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.mae_heteroscedastic_metric"><code class="docutils literal notranslate"><span class="pre">mae_heteroscedastic_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.meanS_heteroscedastic_metric"><code class="docutils literal notranslate"><span class="pre">meanS_heteroscedastic_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.modify_labels"><code class="docutils literal notranslate"><span class="pre">modify_labels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.mse_contamination_metric"><code class="docutils literal notranslate"><span class="pre">mse_contamination_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.mse_heteroscedastic_metric"><code class="docutils literal notranslate"><span class="pre">mse_heteroscedastic_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.quantile_loss"><code class="docutils literal notranslate"><span class="pre">quantile_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.quantile_metric"><code class="docutils literal notranslate"><span class="pre">quantile_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.r2_contamination_metric"><code class="docutils literal notranslate"><span class="pre">r2_contamination_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.r2_heteroscedastic_metric"><code class="docutils literal notranslate"><span class="pre">r2_heteroscedastic_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.sparse_abstention_acc_metric"><code class="docutils literal notranslate"><span class="pre">sparse_abstention_acc_metric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.sparse_abstention_loss"><code class="docutils literal notranslate"><span class="pre">sparse_abstention_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.triple_quantile_loss"><code class="docutils literal notranslate"><span class="pre">triple_quantile_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.plot_metrics"><code class="docutils literal notranslate"><span class="pre">plot_metrics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.build_pytorch_activation"><code class="docutils literal notranslate"><span class="pre">build_pytorch_activation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.build_pytorch_optimizer"><code class="docutils literal notranslate"><span class="pre">build_pytorch_optimizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.get_pytorch_function"><code class="docutils literal notranslate"><span class="pre">get_pytorch_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.pytorch_initialize"><code class="docutils literal notranslate"><span class="pre">pytorch_initialize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.pytorch_mse"><code class="docutils literal notranslate"><span class="pre">pytorch_mse()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.pytorch_xent"><code class="docutils literal notranslate"><span class="pre">pytorch_xent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.set_pytorch_seed"><code class="docutils literal notranslate"><span class="pre">set_pytorch_seed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.set_pytorch_threads"><code class="docutils literal notranslate"><span class="pre">set_pytorch_threads()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#candle.Benchmark"><code class="docutils literal notranslate"><span class="pre">Benchmark</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.Benchmark.check_required_exists"><code class="docutils literal notranslate"><span class="pre">Benchmark.check_required_exists()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.Benchmark.format_benchmark_config_arguments"><code class="docutils literal notranslate"><span class="pre">Benchmark.format_benchmark_config_arguments()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.Benchmark.get_parameter_from_file"><code class="docutils literal notranslate"><span class="pre">Benchmark.get_parameter_from_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.Benchmark.parse_parameters"><code class="docutils literal notranslate"><span class="pre">Benchmark.parse_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.Benchmark.read_config_file"><code class="docutils literal notranslate"><span class="pre">Benchmark.read_config_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.Benchmark.set_locals"><code class="docutils literal notranslate"><span class="pre">Benchmark.set_locals()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#candle.Progbar"><code class="docutils literal notranslate"><span class="pre">Progbar</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.Progbar.update"><code class="docutils literal notranslate"><span class="pre">Progbar.update()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#candle.ArgumentStruct"><code class="docutils literal notranslate"><span class="pre">ArgumentStruct</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.MultiGPUCheckpoint"><code class="docutils literal notranslate"><span class="pre">MultiGPUCheckpoint</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#candle.CyclicLR"><code class="docutils literal notranslate"><span class="pre">CyclicLR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.CyclicLR.on_batch_end"><code class="docutils literal notranslate"><span class="pre">CyclicLR.on_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.CyclicLR.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">CyclicLR.on_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.CyclicLR.on_train_begin"><code class="docutils literal notranslate"><span class="pre">CyclicLR.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#candle.CandleRemoteMonitor"><code class="docutils literal notranslate"><span class="pre">CandleRemoteMonitor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.CandleRemoteMonitor.on_epoch_begin"><code class="docutils literal notranslate"><span class="pre">CandleRemoteMonitor.on_epoch_begin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.CandleRemoteMonitor.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">CandleRemoteMonitor.on_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.CandleRemoteMonitor.on_train_begin"><code class="docutils literal notranslate"><span class="pre">CandleRemoteMonitor.on_train_begin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.CandleRemoteMonitor.on_train_end"><code class="docutils literal notranslate"><span class="pre">CandleRemoteMonitor.on_train_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.CandleRemoteMonitor.save"><code class="docutils literal notranslate"><span class="pre">CandleRemoteMonitor.save()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#candle.LoggingCallback"><code class="docutils literal notranslate"><span class="pre">LoggingCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.LoggingCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">LoggingCallback.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#candle.PermanentDropout"><code class="docutils literal notranslate"><span class="pre">PermanentDropout</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.PermanentDropout.call"><code class="docutils literal notranslate"><span class="pre">PermanentDropout.call()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#candle.TerminateOnTimeOut"><code class="docutils literal notranslate"><span class="pre">TerminateOnTimeOut</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.TerminateOnTimeOut.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">TerminateOnTimeOut.on_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#candle.TerminateOnTimeOut.on_train_begin"><code class="docutils literal notranslate"><span class="pre">TerminateOnTimeOut.on_train_begin()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#candle.AbstentionAdapt_Callback"><code class="docutils literal notranslate"><span class="pre">AbstentionAdapt_Callback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.AbstentionAdapt_Callback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">AbstentionAdapt_Callback.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#candle.Contamination_Callback"><code class="docutils literal notranslate"><span class="pre">Contamination_Callback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#candle.Contamination_Callback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">Contamination_Callback.on_epoch_end()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../shared_installation.html">CANDLE Shared Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute.html">How to Contribute</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">CANDLE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active"><code class="docutils literal notranslate"><span class="pre">candle</span></code></li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/candle/candle.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-candle">
<span id="candle"></span><h1><code class="docutils literal notranslate"><span class="pre">candle</span></code><a class="headerlink" href="#module-candle" title="Permalink to this heading">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#functions" id="id5">Functions</a></p></li>
<li><p><a class="reference internal" href="#classes" id="id6">Classes</a></p></li>
</ul>
</div>
<section id="functions">
<h2><a class="toc-backref" href="#id5">Functions</a><a class="headerlink" href="#functions" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#candle.generate_cross_validation_partition" title="candle.generate_cross_validation_partition"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_cross_validation_partition()</span></code></a>:
This function generates partition indices of samples for cross-</p></li>
<li><p><a class="reference internal" href="#candle.quantile_normalization" title="candle.quantile_normalization"><code class="xref py py-func docutils literal notranslate"><span class="pre">quantile_normalization()</span></code></a>:
This function does quantile normalization to input data. After</p></li>
<li><p><a class="reference internal" href="#candle.load_csv_data" title="candle.load_csv_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_csv_data()</span></code></a>:
Load data from the files specified. Columns corresponding to data</p></li>
<li><p><a class="reference internal" href="#candle.load_Xy_data_noheader" title="candle.load_Xy_data_noheader"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_Xy_data_noheader()</span></code></a>:
Load training and testing data from the files specified, with the first</p></li>
<li><p><a class="reference internal" href="#candle.load_Xy_one_hot_data2" title="candle.load_Xy_one_hot_data2"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_Xy_one_hot_data2()</span></code></a>:
Load training and testing data from the files specified, with a column</p></li>
<li><p><a class="reference internal" href="#candle.select_decorrelated_features" title="candle.select_decorrelated_features"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_decorrelated_features()</span></code></a>:
This function selects features whose mutual absolute correlation</p></li>
<li><p><a class="reference internal" href="#candle.select_features_by_missing_values" title="candle.select_features_by_missing_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_features_by_missing_values()</span></code></a>:
This function returns the indices of the features whose missing rates</p></li>
<li><p><a class="reference internal" href="#candle.select_features_by_variation" title="candle.select_features_by_variation"><code class="xref py py-func docutils literal notranslate"><span class="pre">select_features_by_variation()</span></code></a>:
This function evaluates the variations of individual features and</p></li>
<li><p><a class="reference internal" href="#candle.get_file" title="candle.get_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_file()</span></code></a>:
Downloads a file from a URL if it not already in the cache. Passing the</p></li>
<li><p><a class="reference internal" href="#candle.validate_file" title="candle.validate_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">validate_file()</span></code></a>:
Validates a file against a MD5 hash.</p></li>
<li><p><a class="reference internal" href="#candle.fetch_file" title="candle.fetch_file"><code class="xref py py-func docutils literal notranslate"><span class="pre">fetch_file()</span></code></a>:
Convert URL to file path and download the file if it is not already</p></li>
<li><p><a class="reference internal" href="#candle.keras_default_config" title="candle.keras_default_config"><code class="xref py py-func docutils literal notranslate"><span class="pre">keras_default_config()</span></code></a>:
Defines parameters that intervine in different functions using the keras</p></li>
<li><p><a class="reference internal" href="#candle.set_up_logger" title="candle.set_up_logger"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_up_logger()</span></code></a>:
Set up the event logging system. Two handlers are created. One to send</p></li>
<li><p><a class="reference internal" href="#candle.str2bool" title="candle.str2bool"><code class="xref py py-func docutils literal notranslate"><span class="pre">str2bool()</span></code></a>:
This is taken from:</p></li>
<li><p><a class="reference internal" href="#candle.verify_path" title="candle.verify_path"><code class="xref py py-func docutils literal notranslate"><span class="pre">verify_path()</span></code></a>:
Verify if a directory path exists locally. If the path does not exist,</p></li>
<li><p><a class="reference internal" href="#candle.add_cluster_noise" title="candle.add_cluster_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_cluster_noise()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.add_column_noise" title="candle.add_column_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_column_noise()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.add_gaussian_noise" title="candle.add_gaussian_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_gaussian_noise()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.add_noise" title="candle.add_noise"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_noise()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.label_flip" title="candle.label_flip"><code class="xref py py-func docutils literal notranslate"><span class="pre">label_flip()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.label_flip_correlated" title="candle.label_flip_correlated"><code class="xref py py-func docutils literal notranslate"><span class="pre">label_flip_correlated()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.combat_batch_effect_removal" title="candle.combat_batch_effect_removal"><code class="xref py py-func docutils literal notranslate"><span class="pre">combat_batch_effect_removal()</span></code></a>:
This function corrects for batch effect in data.</p></li>
<li><p><a class="reference internal" href="#candle.coxen_multi_drug_gene_selection" title="candle.coxen_multi_drug_gene_selection"><code class="xref py py-func docutils literal notranslate"><span class="pre">coxen_multi_drug_gene_selection()</span></code></a>:
This function uses the COXEN approach to select genes for predicting the</p></li>
<li><p><a class="reference internal" href="#candle.coxen_single_drug_gene_selection" title="candle.coxen_single_drug_gene_selection"><code class="xref py py-func docutils literal notranslate"><span class="pre">coxen_single_drug_gene_selection()</span></code></a>:
This function selects genes for drug response prediction using the COXEN</p></li>
<li><p><a class="reference internal" href="#candle.generate_gene_set_data" title="candle.generate_gene_set_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_gene_set_data()</span></code></a>:
This function generates genomic data summarized at the gene set level.</p></li>
<li><p><a class="reference internal" href="#candle.check_flag_conflicts" title="candle.check_flag_conflicts"><code class="xref py py-func docutils literal notranslate"><span class="pre">check_flag_conflicts()</span></code></a>:
Check if parameters that must be exclusive are used in conjunction. The</p></li>
<li><p><a class="reference internal" href="#candle.finalize_parameters" title="candle.finalize_parameters"><code class="xref py py-func docutils literal notranslate"><span class="pre">finalize_parameters()</span></code></a>:
Utility to parse parameters in common as well as parameters particular</p></li>
<li><p><a class="reference internal" href="#candle.parse_from_dictlist" title="candle.parse_from_dictlist"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_from_dictlist()</span></code></a>:
Functionality to parse options.</p></li>
<li><p><a class="reference internal" href="#candle.compute_empirical_calibration_interpolation" title="candle.compute_empirical_calibration_interpolation"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_empirical_calibration_interpolation()</span></code></a>:
Use the arrays provided to estimate an empirical mapping between</p></li>
<li><p><a class="reference internal" href="#candle.compute_statistics_heteroscedastic" title="candle.compute_statistics_heteroscedastic"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_statistics_heteroscedastic()</span></code></a>:
Extracts ground truth, mean prediction, error, standard deviation of</p></li>
<li><p><a class="reference internal" href="#candle.compute_statistics_homoscedastic" title="candle.compute_statistics_homoscedastic"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_statistics_homoscedastic()</span></code></a>:
Extracts ground truth, mean prediction, error and standard deviation of</p></li>
<li><p><a class="reference internal" href="#candle.compute_statistics_homoscedastic_summary" title="candle.compute_statistics_homoscedastic_summary"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_statistics_homoscedastic_summary()</span></code></a>:
Extracts ground truth, mean prediction, error and standard deviation of</p></li>
<li><p><a class="reference internal" href="#candle.compute_statistics_quantile" title="candle.compute_statistics_quantile"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_statistics_quantile()</span></code></a>:
Extracts ground truth, 50th percentile mean prediction, low percentile</p></li>
<li><p><a class="reference internal" href="#candle.generate_index_distribution" title="candle.generate_index_distribution"><code class="xref py py-func docutils literal notranslate"><span class="pre">generate_index_distribution()</span></code></a>:
Generates a vector of indices to partition the data for training. NO</p></li>
<li><p><a class="reference internal" href="#candle.split_data_for_empirical_calibration" title="candle.split_data_for_empirical_calibration"><code class="xref py py-func docutils literal notranslate"><span class="pre">split_data_for_empirical_calibration()</span></code></a>:
Extracts a portion of the arrays provided for the computation of the</p></li>
<li><p><a class="reference internal" href="#candle.plot_2d_density_sigma_vs_error" title="candle.plot_2d_density_sigma_vs_error"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_2d_density_sigma_vs_error()</span></code></a>:
Functionality to plot a 2D histogram of the distribution of the standard</p></li>
<li><p><a class="reference internal" href="#candle.plot_array" title="candle.plot_array"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_array()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.plot_calibrated_std" title="candle.plot_calibrated_std"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_calibrated_std()</span></code></a>:
Functionality to plot values in testing set after calibration. An</p></li>
<li><p><a class="reference internal" href="#candle.plot_calibration_interpolation" title="candle.plot_calibration_interpolation"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_calibration_interpolation()</span></code></a>:
Functionality to plot empirical calibration curves estimated by</p></li>
<li><p><a class="reference internal" href="#candle.plot_contamination" title="candle.plot_contamination"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_contamination()</span></code></a>:
Functionality to plot results for the contamination model. This includes</p></li>
<li><p><a class="reference internal" href="#candle.plot_decile_predictions" title="candle.plot_decile_predictions"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_decile_predictions()</span></code></a>:
Functionality to plot the mean of the deciles predicted. The plot</p></li>
<li><p><a class="reference internal" href="#candle.plot_density_observed_vs_predicted" title="candle.plot_density_observed_vs_predicted"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_density_observed_vs_predicted()</span></code></a>:
Functionality to plot a 2D histogram of the distribution of observed</p></li>
<li><p><a class="reference internal" href="#candle.plot_histogram_error_per_sigma" title="candle.plot_histogram_error_per_sigma"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_histogram_error_per_sigma()</span></code></a>:
Functionality to plot a 1D histogram of the distribution of computed errors</p></li>
<li><p><a class="reference internal" href="#candle.plot_history" title="candle.plot_history"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_history()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.plot_scatter" title="candle.plot_scatter"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_scatter()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.clr_callback" title="candle.clr_callback"><code class="xref py py-func docutils literal notranslate"><span class="pre">clr_callback()</span></code></a>:
Creates keras callback for cyclical learning rate.</p></li>
<li><p><a class="reference internal" href="#candle.clr_check_args" title="candle.clr_check_args"><code class="xref py py-func docutils literal notranslate"><span class="pre">clr_check_args()</span></code></a>:
Checks if the arguments for cyclical learning rate are valid.</p></li>
<li><p><a class="reference internal" href="#candle.clr_set_args" title="candle.clr_set_args"><code class="xref py py-func docutils literal notranslate"><span class="pre">clr_set_args()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.build_initializer" title="candle.build_initializer"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_initializer()</span></code></a>:
Set the initializer to the appropriate Keras initializer function based</p></li>
<li><p><a class="reference internal" href="#candle.build_optimizer" title="candle.build_optimizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_optimizer()</span></code></a>:
Set the optimizer to the appropriate Keras optimizer function based on</p></li>
<li><p><a class="reference internal" href="#candle.compute_trainable_params" title="candle.compute_trainable_params"><code class="xref py py-func docutils literal notranslate"><span class="pre">compute_trainable_params()</span></code></a>:
Extract number of parameters from the given Keras model</p></li>
<li><p><a class="reference internal" href="#candle.get_function" title="candle.get_function"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_function()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.mae" title="candle.mae"><code class="xref py py-func docutils literal notranslate"><span class="pre">mae()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.mse" title="candle.mse"><code class="xref py py-func docutils literal notranslate"><span class="pre">mse()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.r2" title="candle.r2"><code class="xref py py-func docutils literal notranslate"><span class="pre">r2()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.register_permanent_dropout" title="candle.register_permanent_dropout"><code class="xref py py-func docutils literal notranslate"><span class="pre">register_permanent_dropout()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.set_parallelism_threads" title="candle.set_parallelism_threads"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_parallelism_threads()</span></code></a>:
Set the number of parallel threads according to the number available on</p></li>
<li><p><a class="reference internal" href="#candle.set_seed" title="candle.set_seed"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_seed()</span></code></a>:
Set the random number seed to the desired value.</p></li>
<li><p><a class="reference internal" href="#candle.abstention_acc_class_i_metric" title="candle.abstention_acc_class_i_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">abstention_acc_class_i_metric()</span></code></a>:
Function to estimate accuracy over the class i prediction after removing</p></li>
<li><p><a class="reference internal" href="#candle.abstention_acc_metric" title="candle.abstention_acc_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">abstention_acc_metric()</span></code></a>:
Abstained accuracy: Function to estimate accuracy over the predicted</p></li>
<li><p><a class="reference internal" href="#candle.abstention_class_i_metric" title="candle.abstention_class_i_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">abstention_class_i_metric()</span></code></a>:
Function to estimate fraction of the samples where the model is</p></li>
<li><p><a class="reference internal" href="#candle.abstention_loss" title="candle.abstention_loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">abstention_loss()</span></code></a>:
Function to compute abstention loss. It is composed by two terms: (i)</p></li>
<li><p><a class="reference internal" href="#candle.abstention_metric" title="candle.abstention_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">abstention_metric()</span></code></a>:
Function to estimate fraction of the samples where the model is</p></li>
<li><p><a class="reference internal" href="#candle.acc_class_i_metric" title="candle.acc_class_i_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">acc_class_i_metric()</span></code></a>:
Function to estimate accuracy over the ith class prediction. This</p></li>
<li><p><a class="reference internal" href="#candle.add_index_to_output" title="candle.add_index_to_output"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_index_to_output()</span></code></a>:
This function adds a column to the training output to store the indices</p></li>
<li><p><a class="reference internal" href="#candle.add_model_output" title="candle.add_model_output"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_model_output()</span></code></a>:
This function modifies the last dense layer in the passed keras model.</p></li>
<li><p><a class="reference internal" href="#candle.contamination_loss" title="candle.contamination_loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">contamination_loss()</span></code></a>:
Function to compute contamination loss. It is composed by two terms: (i)</p></li>
<li><p><a class="reference internal" href="#candle.heteroscedastic_loss" title="candle.heteroscedastic_loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">heteroscedastic_loss()</span></code></a>:
This function computes the heteroscedastic loss for the heteroscedastic</p></li>
<li><p><a class="reference internal" href="#candle.mae_contamination_metric" title="candle.mae_contamination_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">mae_contamination_metric()</span></code></a>:
This function computes the mean absolute error (mae) for the</p></li>
<li><p><a class="reference internal" href="#candle.mae_heteroscedastic_metric" title="candle.mae_heteroscedastic_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">mae_heteroscedastic_metric()</span></code></a>:
This function computes the mean absolute error (mae) for the</p></li>
<li><p><a class="reference internal" href="#candle.meanS_heteroscedastic_metric" title="candle.meanS_heteroscedastic_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">meanS_heteroscedastic_metric()</span></code></a>:
This function computes the mean log of the variance (log S) for the</p></li>
<li><p><a class="reference internal" href="#candle.modify_labels" title="candle.modify_labels"><code class="xref py py-func docutils literal notranslate"><span class="pre">modify_labels()</span></code></a>:
This function generates a categorical representation with a class added</p></li>
<li><p><a class="reference internal" href="#candle.mse_contamination_metric" title="candle.mse_contamination_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">mse_contamination_metric()</span></code></a>:
This function computes the mean squared error (mse) for the</p></li>
<li><p><a class="reference internal" href="#candle.mse_heteroscedastic_metric" title="candle.mse_heteroscedastic_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">mse_heteroscedastic_metric()</span></code></a>:
This function computes the mean squared error (mse) for the</p></li>
<li><p><a class="reference internal" href="#candle.quantile_loss" title="candle.quantile_loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">quantile_loss()</span></code></a>:
This function computes the quantile loss for a given quantile fraction.</p></li>
<li><p><a class="reference internal" href="#candle.quantile_metric" title="candle.quantile_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">quantile_metric()</span></code></a>:
This function computes the quantile metric for a given quantile and</p></li>
<li><p><a class="reference internal" href="#candle.r2_contamination_metric" title="candle.r2_contamination_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">r2_contamination_metric()</span></code></a>:
This function computes the r2 for the contamination model. The r2 is</p></li>
<li><p><a class="reference internal" href="#candle.r2_heteroscedastic_metric" title="candle.r2_heteroscedastic_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">r2_heteroscedastic_metric()</span></code></a>:
This function computes the r2 for the heteroscedastic model. The r2 is</p></li>
<li><p><a class="reference internal" href="#candle.sparse_abstention_acc_metric" title="candle.sparse_abstention_acc_metric"><code class="xref py py-func docutils literal notranslate"><span class="pre">sparse_abstention_acc_metric()</span></code></a>:
Abstained accuracy: Function to estimate accuracy over the predicted</p></li>
<li><p><a class="reference internal" href="#candle.sparse_abstention_loss" title="candle.sparse_abstention_loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">sparse_abstention_loss()</span></code></a>:
Function to compute abstention loss. It is composed by two terms: (i)</p></li>
<li><p><a class="reference internal" href="#candle.triple_quantile_loss" title="candle.triple_quantile_loss"><code class="xref py py-func docutils literal notranslate"><span class="pre">triple_quantile_loss()</span></code></a>:
This function computes the quantile loss for the median and low and high</p></li>
<li><p><a class="reference internal" href="#candle.plot_metrics" title="candle.plot_metrics"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_metrics()</span></code></a>:
Plots keras training curves history.</p></li>
<li><p><a class="reference internal" href="#candle.build_pytorch_activation" title="candle.build_pytorch_activation"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_pytorch_activation()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.build_pytorch_optimizer" title="candle.build_pytorch_optimizer"><code class="xref py py-func docutils literal notranslate"><span class="pre">build_pytorch_optimizer()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.get_pytorch_function" title="candle.get_pytorch_function"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_pytorch_function()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.pytorch_initialize" title="candle.pytorch_initialize"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytorch_initialize()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.pytorch_mse" title="candle.pytorch_mse"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytorch_mse()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.pytorch_xent" title="candle.pytorch_xent"><code class="xref py py-func docutils literal notranslate"><span class="pre">pytorch_xent()</span></code></a>:
Undocumented.</p></li>
<li><p><a class="reference internal" href="#candle.set_pytorch_seed" title="candle.set_pytorch_seed"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_pytorch_seed()</span></code></a>:
Set the random number seed to the desired value</p></li>
<li><p><a class="reference internal" href="#candle.set_pytorch_threads" title="candle.set_pytorch_threads"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_pytorch_threads()</span></code></a>:
Undocumented.</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="candle.generate_cross_validation_partition">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">generate_cross_validation_partition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">group_label</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_folds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_repeats</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">portions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/data_preprocessing_utils.html#generate_cross_validation_partition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.generate_cross_validation_partition" title="Permalink to this definition">¶</a></dt>
<dd><p>This function generates partition indices of samples for cross-
validation analysis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>group_label</strong> – 1-D array or list of group labels of samples. If there are no groups in samples, a list of
sample indices can be supplied for generating partitions based on individual samples rather than sample groups.</p></li>
<li><p><strong>n_folds</strong> (<em>int</em>) – positive integer larger than 1, indicating the number of folds for cross-validation. Default is 5.</p></li>
<li><p><strong>n_repeats</strong> (<em>int</em>) – positive integer, indicating how many times the n_folds cross-validation should be repeated.
So the total number of cross-validation trials is n_folds * n_repeats. Default is 1.</p></li>
<li><p><strong>portions</strong> – 1-D array or list of positive integers, indicating the number of data folds in each set
(e.g. training set, testing set, or validation set) after partitioning. The summation of elements
in portions must be equal to n_folds. Default is [1, n_folds - 1].</p></li>
<li><p><strong>random_seed</strong> (<em>int</em>) – positive integer, the seed for random generator. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of n_folds * n_repeats lists, each of which contains len(portions) sample index lists for
a cross-validation trial.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.quantile_normalization">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">quantile_normalization</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/data_preprocessing_utils.html#quantile_normalization"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.quantile_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>This function does quantile normalization to input data. After
normalization, the samples (rows) in output data follow the same
distribution, which is the average distribution calculated based on all
samples. This function allows missing values, and assume missing values
occur at random.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – numpy array or pandas data frame of numeric values, with a shape of [n_samples, n_features].</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy array or pandas data frame containing the data after quantile normalization.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.load_csv_data">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">load_csv_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">','</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrows</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">onehot_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_dataframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7102</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/data_utils.html#load_csv_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.load_csv_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data from the files specified. Columns corresponding to data
features and labels can be specified. A one-hot encoding can be used for
either features or labels. If validation_split is specified, trainig data
is further split into training and validation partitions. pandas DataFrames
are used to load and pre-process the data. If specified, those DataFrames
are returned. Otherwise just values are returned. Labels to output can be
integer labels (for classification) or continuous labels (for regression).
Columns to load can be specified, randomly selected or a subset can be
dropped. Order of rows can be shuffled. Data can be rescaled. This function
assumes that the files contain a header with column names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_path</strong> – Name of the file to load the training data.</p></li>
<li><p><strong>test_path</strong> – Name of the file to load the testing data. (Optional).</p></li>
<li><p><strong>sep</strong> – Character used as column separator. (Default: ‘,’, comma separated values).</p></li>
<li><p><strong>nrows</strong> (<em>int</em>) – Number of rows to load from the files. (Default: None, all the rows are used).</p></li>
<li><p><strong>x_cols</strong> – List of columns to use as features. (Default: None).</p></li>
<li><p><strong>y_cols</strong> – List of columns to use as labels. (Default: None).</p></li>
<li><p><strong>drop_cols</strong> – List of columns to drop from the files being loaded. (Default: None, all the columns are used).</p></li>
<li><p><strong>onehot_cols</strong> – List of columns to one-hot encode. (Default: None).</p></li>
<li><p><strong>n_cols</strong> (<em>int</em>) – Number of columns to load from the files. (Default: None).</p></li>
<li><p><strong>random_cols</strong> (<em>boolean</em>) – Boolean flag to indicate random selection of columns.
If True a number of n_cols columns is randomly selected, if False
the specified columns are used. (Default: False).</p></li>
<li><p><strong>shuffle</strong> (<em>boolean</em>) – Boolean flag to indicate row shuffling. If True the rows are
re-ordered, if False the order in which rows are read is preserved.
(Default: False, no permutation of the loading row order).</p></li>
<li><p><strong>scaling</strong> (<em>string</em>) – <p>String describing type of scaling to apply.
Options recognized: ‘maxabs’, ‘minmax’, ‘std’.</p>
<ul>
<li><p>maxabs: scales data to range [-1 to 1].</p></li>
<li><p>minmax: scales data to range [-1 to 1].</p></li>
<li><p>std   : scales data to normal variable with mean 0 and standard deviation 1. (Default: None, no scaling).</p></li>
</ul>
</p></li>
<li><p><strong>dtype</strong> – Data type to use for the output pandas DataFrames. (Default: None).</p></li>
<li><p><strong>validation_split</strong> (<em>float</em>) – Fraction of training data to set aside for validation.
(Default: None, no validation partition is constructed).</p></li>
<li><p><strong>return_dataframe</strong> (<em>boolean</em>) – Boolean flag to indicate that the pandas DataFrames
used for data pre-processing are to be returned.
(Default: True, pandas DataFrames are returned).</p></li>
<li><p><strong>return_header</strong> (<em>boolean</em>) – Boolean flag to indicate if the column headers are
to be returned.
(Default: False, no column headers are separetely returned).</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Value to intialize or re-seed the generator.
(Default: DEFAULT_SEED defined in default_utils).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tuples of data features and labels are returned, for     train, validation and testing partitions, together with the column     names (headers). The specific objects to return depend     on the options selected.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.load_Xy_data_noheader">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">load_Xy_data_noheader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes:</span> <span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">usecols:</span> <span class="pre">~typing.Optional[~typing.List]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/data_utils.html#load_Xy_data_noheader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.load_Xy_data_noheader" title="Permalink to this definition">¶</a></dt>
<dd><p>Load training and testing data from the files specified, with the first
column to use as label. Construct corresponding training and testing pandas
DataFrames, separated into data (i.e. features) and labels. Labels to
output are one-hot encoded (categorical). Columns to load can be selected.
Data can be rescaled. Training and testing partitions (coming from the
respective files) are preserved. This function assumes that the files do
not contain a header.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>string</em>) – Name of the file to load the training data.</p></li>
<li><p><strong>test_file</strong> (<em>string</em>) – Name of the file to load the testing data.</p></li>
<li><p><strong>classes</strong> (<em>int</em>) – Number of total classes to consider when
building the categorical (one-hot) label encoding.</p></li>
<li><p><strong>usecols</strong> – List of column indices to load from the files.
(Default: None, all the columns are used).</p></li>
<li><p><strong>scaling</strong> (<em>string</em>) – <p>String describing type of scaling to apply.
Options recognized: ‘maxabs’, ‘minmax’, ‘std’.</p>
<ul>
<li><p>maxabs: scales data to range [-1 to 1].</p></li>
<li><p>minmax: scales data to range [-1 to 1].</p></li>
<li><p>std   : scales data to normal variable with mean 0 and standard deviation 1.         (Default: None, no scaling).</p></li>
</ul>
</p></li>
<li><p><strong>dtype</strong> – Data type to use for the output pandas DataFrames.
(Default: DEFAULT_DATATYPE defined in default_utils).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of pandas DataFrames where</p>
<ul class="simple">
<li><p>X_train - Data features for training loaded in a pandas DataFrame and             pre-processed as specified.</p></li>
<li><p>Y_train - Data labels for training loaded in a pandas DataFrame.             One-hot encoding (categorical) is used.</p></li>
<li><p>X_test - Data features for testing loaded in a pandas DataFrame and             pre-processed as specified.</p></li>
<li><p>Y_test - Data labels for testing loaded in a pandas DataFrame.             One-hot encoding (categorical) is used.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.load_Xy_one_hot_data2">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">load_Xy_one_hot_data2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_file:</span> <span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_col:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_cols:</span> <span class="pre">~typing.Optional[~typing.List]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cols:</span> <span class="pre">~typing.Optional[int]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling:</span> <span class="pre">~typing.Optional[str]</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype=&lt;class</span> <span class="pre">'numpy.float32'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">7102</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/data_utils.html#load_Xy_one_hot_data2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.load_Xy_one_hot_data2" title="Permalink to this definition">¶</a></dt>
<dd><p>Load training and testing data from the files specified, with a column
indicated to use as label. Further split trainig data into training and
validation partitions, and construct corresponding training, validation and
testing pandas DataFrames, separated into data (i.e. features) and labels.
Labels to output are one-hot encoded (categorical). Columns to load can be
selected or dropped. Order of rows can be shuffled. Data can be rescaled.
Training and testing partitions (coming from the respective files) are
preserved, but training is split into training and validation partitions.
This function assumes that the files contain a header with column names.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_file</strong> (<em>string</em>) – Name of the file to load the training data.</p></li>
<li><p><strong>test_file</strong> (<em>string</em>) – Name of the file to load the testing data.</p></li>
<li><p><strong>class_col</strong> (<em>int</em>) – Index of the column to use as the label.         (Default: None, this would cause the function to fail, a label         has to be indicated at calling).</p></li>
<li><p><strong>drop_cols</strong> (<em>List</em>) – List of column names to drop from the files being loaded.         (Default: None, all the columns are used).</p></li>
<li><p><strong>n_cols</strong> (<em>int</em>) – Number of columns to load from the files.         (Default: None, all the columns are used).</p></li>
<li><p><strong>shuffle</strong> (<em>boolean</em>) – Boolean flag to indicate row shuffling. If True the rows are         re-ordered, if False the order in which rows are loaded is preserved.         (Default: False, no permutation of the loading row order).</p></li>
<li><p><strong>scaling</strong> (<em>string</em>) – <p>String describing type of scaling to apply.         Options recognized: ‘maxabs’, ‘minmax’, ‘std’.</p>
<ul>
<li><p>maxabs: scales data to range [-1 to 1].</p></li>
<li><p>minmax: scales data to range [-1 to 1].</p></li>
<li><p>std: scales data to normal variable with mean 0 and standard deviation 1.             (Default: None, no scaling).</p></li>
</ul>
</p></li>
<li><p><strong>validation_split</strong> (<em>float</em>) – Fraction of training data to set aside for validation.         (Default: 0.1, ten percent of the training data is used for the validation partition).</p></li>
<li><p><strong>dtype</strong> – Data type to use for the output pandas DataFrames.         (Default: DEFAULT_DATATYPE defined in default_utils).</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Value to intialize or re-seed the generator.         (Default: DEFAULT_SEED defined in default_utils).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of pandas DataFrames where</p>
<ul class="simple">
<li><p>X_train: Data features for training loaded in a pandas DataFrame and             pre-processed as specified.</p></li>
<li><p>y_train: Data labels for training loaded in a pandas DataFrame.             One-hot encoding (categorical) is used.</p></li>
<li><p>X_val: Data features for validation loaded in a pandas DataFrame and             pre-processed as specified.</p></li>
<li><p>y_val: Data labels for validation loaded in a pandas DataFrame.             One-hot encoding (categorical) is used.</p></li>
<li><p>X_test: Data features for testing loaded in a pandas DataFrame and             pre-processed as specified.</p></li>
<li><p>y_test: Data labels for testing loaded in a pandas DataFrame.             One-hot encoding (categorical) is used.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.select_decorrelated_features">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">select_decorrelated_features</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pearson'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/feature_selection_utils.html#select_decorrelated_features"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.select_decorrelated_features" title="Permalink to this definition">¶</a></dt>
<dd><p>This function selects features whose mutual absolute correlation
coefficients are smaller than a threshold. It allows missing values in
data. The correlation coefficient of two features are calculated based on
the observations that are not missing in both features. Features with only
one or no value present and features with a zero standard deviation are not
considered for selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array or pandas data frame of numeric values, with a shape of [n_samples, n_features].</p></li>
<li><p><strong>method</strong> (<em>string</em>) – <p>indicating the method used for calculating correlation coefficient. Default is ‘pearson’.</p>
<ul>
<li><p>pearson: Pearson correlation coefficient</p></li>
<li><p>kendall: Kendall Tau correlation coefficient</p></li>
<li><p>spearman: Spearman rank correlation coefficient</p></li>
</ul>
</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – If two features have an absolute correlation coefficient higher than threshold,        one of the features is removed. If threshold is None, a feature is removed only when the two features         are exactly identical. Default is None.</p></li>
<li><p><strong>random_seed</strong> (<em>int</em>) – seed of random generator for ordering the features. If it is None, features         are not re-ordered before feature selection and thus the first feature is always selected. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1-D numpy array containing the indices of selected features.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.select_features_by_missing_values">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">select_features_by_missing_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/feature_selection_utils.html#select_features_by_missing_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.select_features_by_missing_values" title="Permalink to this definition">¶</a></dt>
<dd><p>This function returns the indices of the features whose missing rates
are smaller than the threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array or pandas data frame of numeric values, with a shape of [n_samples, n_features]</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – range of [0, 1]. Features with a missing rate smaller than threshold will be selected.         Default is 0.1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1-D numpy array containing the indices of selected features</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.select_features_by_variation">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">select_features_by_variation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variation_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'var'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">portion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">draw_histogram</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/feature_selection_utils.html#select_features_by_variation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.select_features_by_variation" title="Permalink to this definition">¶</a></dt>
<dd><p>This function evaluates the variations of individual features and
returns the indices of features with large variations. Missing values are
ignored in evaluating variation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array or pandas data frame of numeric values, with a shape of [n_samples, n_features].</p></li>
<li><p><strong>variation_metric</strong> (<em>string</em>) – string indicating the metric used for evaluating feature variation. ‘var’ indicates variance;         ‘std’ indicates standard deviation; ‘mad’ indicates median absolute deviation. Default is ‘var’.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Features with a variation larger than threshold will be selected. Default is None.</p></li>
<li><p><strong>portion</strong> (<em>float</em>) – float in the range of [0, 1]. It is the portion of features to be selected based on variation.         The number of selected features will be the smaller of int(portion * n_features) and the total number of         features with non-missing variations. Default is None. threshold and portion can not take real values         and be used simultaneously.</p></li>
<li><p><strong>draw_histogram</strong> (<em>bool</em>) – whether to draw a histogram of feature variations. Default is False.</p></li>
<li><p><strong>bins</strong> (<em>int</em>) – positive integer, the number of bins in the histogram. Default is the smaller of 50 and the number of         features with non-missing variations.</p></li>
<li><p><strong>log</strong> (<em>bool</em>) – whether the histogram should be drawn on log scale.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1-D numpy array containing the indices of selected features. If both threshold and         portion are None, indices will be an empty array.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.get_file">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">get_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fname</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">origin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unpack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">md5_hash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_subdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'common'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datadir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/candle/file_utils.html#get_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.get_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads a file from a URL if it not already in the cache. Passing the
MD5 hash will verify the file after download as well as if it is already
present in the cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fname</strong> (<em>string</em>) – name of the file</p></li>
<li><p><strong>origin</strong> (<em>string</em>) – original URL of the file</p></li>
<li><p><strong>unpack</strong> (<em>bool</em>) – whether the file should be decompressed</p></li>
<li><p><strong>md5_hash</strong> (<em>string</em>) – MD5 hash of the file for verification</p></li>
<li><p><strong>cache_subdir</strong> (<em>string</em>) – directory being used as the cache</p></li>
<li><p><strong>datadir</strong> (<em>string</em>) – if set, datadir becomes its setting (which could be e.g. an absolute path)         and cache_subdir no longer matters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Path to the downloaded file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.validate_file">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">validate_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fpath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">md5_hash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/candle/file_utils.html#validate_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.validate_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates a file against a MD5 hash.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fpath</strong> (<em>string</em>) – path to the file being validated</p></li>
<li><p><strong>md5_hash</strong> (<em>string</em>) – the MD5 hash being validated against</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the file is valid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.fetch_file">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">fetch_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">link</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subdir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unpack</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">md5_hash</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="../_modules/candle/helper_utils.html#fetch_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.fetch_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert URL to file path and download the file if it is not already
present in spedified cache.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>link</strong> (<em>string</em>) – URL of the file to download</p></li>
<li><p><strong>subdir</strong> (<em>string</em>) – Local path to check for cached file.</p></li>
<li><p><strong>unpack</strong> (<em>bool</em>) – Flag to specify if the file to download should be decompressed too.         (default: False, no decompression)</p></li>
<li><p><strong>md5_hash</strong> (<em>string</em>) – MD5 hash used as a checksum to verify data integrity.         Verification is carried out if a hash is provided.         (default: None, no verification)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>local path to the downloaded, or cached, file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.keras_default_config">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">keras_default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/candle/helper_utils.html#keras_default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.keras_default_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines parameters that intervine in different functions using the keras
defaults.</p>
<p>This helps to keep consistency in parameters between frameworks.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.set_up_logger">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">set_up_logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Logger</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt_line</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'[%(asctime)s</span> <span class="pre">%(process)d]</span> <span class="pre">%(message)s'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt_date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'%Y-%m-%d</span> <span class="pre">%H:%M:%S'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/candle/helper_utils.html#set_up_logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.set_up_logger" title="Permalink to this definition">¶</a></dt>
<dd><p>Set up the event logging system. Two handlers are created. One to send
log records to a specified file and one to send log records to the
(defaulf) sys.stderr stream. The logger and the file handler are set to
DEBUG logging level. The stream handler is set to INFO logging level, or to
DEBUG logging level if the verbose flag is specified. Logging messages
which are less severe than the level set will be ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfile</strong> (<em>string</em>) – File to store the log records</p></li>
<li><p><strong>logger</strong> (<em>Logger</em>) – Python object for the logging interface</p></li>
<li><p><strong>verbose</strong> (<em>boolean</em>) – Flag to increase the logging level from INFO to DEBUG.         It only applies to the stream handler.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.str2bool">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">str2bool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/candle/helper_utils.html#str2bool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.str2bool" title="Permalink to this definition">¶</a></dt>
<dd><p>This is taken from:
<a class="reference external" href="https://stackoverflow.com/questions/15008758/parsing-boolean-values-with">https://stackoverflow.com/questions/15008758/parsing-boolean-values-with</a>-
argparse Because type=bool is not interpreted as a bool and
action=’store_true’ cannot be undone.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>v</strong> (<em>string</em>) – String to interpret</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Boolean value. It raises and exception if the provided string cannot         be interpreted as a boolean type.</p>
<ul class="simple">
<li><p>Strings recognized as boolean True :             ‘yes’, ‘true’, ‘t’, ‘y’, ‘1’ and uppercase versions (where applicable).</p></li>
<li><p>Strings recognized as boolean False :             ‘no’, ‘false’, ‘f’, ‘n’, ‘0’ and uppercase versions (where applicable).</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.verify_path">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">verify_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/candle/helper_utils.html#verify_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.verify_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Verify if a directory path exists locally. If the path does not exist,
but is a valid path, it recursivelly creates the specified directory path
structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>string</em>) – Description of local directory path</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.add_cluster_noise">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">add_cluster_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_noise_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/noise_utils.html#add_cluster_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.add_cluster_noise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.add_column_noise">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">add_column_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_ids</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/noise_utils.html#add_column_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.add_column_noise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.add_gaussian_noise">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">add_gaussian_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/noise_utils.html#add_gaussian_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.add_gaussian_noise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.add_noise">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">add_noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/noise_utils.html#add_noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.add_noise" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.label_flip">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">label_flip</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_data_categorical</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_noise_level</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/noise_utils.html#label_flip"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.label_flip" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.label_flip_correlated">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">label_flip_correlated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_data_categorical</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_noise_level</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_ids</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/noise_utils.html#label_flip_correlated"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.label_flip_correlated" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.combat_batch_effect_removal">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">combat_batch_effect_removal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numerical_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/P1_utils.html#combat_batch_effect_removal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.combat_batch_effect_removal" title="Permalink to this definition">¶</a></dt>
<dd><p>This function corrects for batch effect in data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – pandas data frame of numeric values, with a size of (n_features, n_samples)</p></li>
<li><p><strong>batch_labels</strong> – pandas series, with a length of n_samples. It should provide the batch labels of samples.         Its indices are the same as the column names (sample names) in “data”.</p></li>
<li><p><strong>model</strong> – an object of patsy.design_info.DesignMatrix. It is a design matrix describing the covariate         information on the samples that could cause batch effects. If not provided, this function         will attempt to coarsely correct just based on the information provided in “batch”.</p></li>
<li><p><strong>numerical_covariates</strong> – a list of the names of covariates in “model” that are numerical rather than         categorical.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pandas data frame of numeric values, with a size of (n_features, n_samples).         It is the data with batch effects corrected.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.coxen_multi_drug_gene_selection">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">coxen_multi_drug_gene_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drug_response_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drug_response_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tumor_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drug_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_power_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'lm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predictive_gene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generalization_power_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ccc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_generalizable_gene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">union_of_single_drug_selection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/P1_utils.html#coxen_multi_drug_gene_selection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.coxen_multi_drug_gene_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the COXEN approach to select genes for predicting the
response of multiple drugs. It assumes no missing data exist. It works in
three modes. (1) If union_of_single_drug_selection is True,
prediction_power_measure must be either ‘pearson’ or ‘mutual_info’. This
functions runs coxen_single_drug_gene_selection for every drug with the
parameter setting and takes the union of the selected genes of every drug
as the output. The size of the selected gene set may be larger than
num_generalizable_gene. (2) If union_of_single_drug_selection is False and
prediction_power_measure is ‘lm’, this function uses a linear model to fit
the response of multiple drugs using the expression of a gene, while the
drugs are one-hot encoded. The p-value associated with the coefficient of
gene expression is used as the prediction power measure, according to which
num_predictive_gene genes will be selected. Then, among the predictive
genes, num_generalizable_gene generalizable genes will be  selected. (3) If
union_of_single_drug_selection is False and prediction_power_measure is
‘pearson’ or ‘mutual_info’, for each drug this functions ranks the genes
according to their power of predicting the response of the drug. The union
of an equal number of predictive genes for every drug will be generated,
and its size must be at least num_predictive_gene. Then,
num_generalizable_gene generalizable genes will be selected.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_data</strong> – pandas data frame of gene expressions of tumors, for which drug response is known.         Its size is [n_source_samples, n_features].</p></li>
<li><p><strong>target_data</strong> – pandas data frame of gene expressions of tumors, for which drug response needs to be predicted.         Its size is [n_target_samples, n_features]. source_data and target_data have the same set         of features and the orders of features must match.</p></li>
<li><p><strong>drug_response_data</strong> – pandas data frame of drug response that must include a column of         drug response values, a column of tumor IDs, and a column of drug IDs.</p></li>
<li><p><strong>drug_response_col</strong> – non-negative integer or string. If integer, it is the column index of         drug response in drug_response_data. If string, it is the column name of drug response.</p></li>
<li><p><strong>tumor_col</strong> – non-negative integer or string. If integer, it is the column index of tumor IDs         in drug_response_data. If string, it is the column name of tumor IDs.</p></li>
<li><p><strong>drug_col</strong> – non-negative integer or string.         If integer, it is the column index of drugs in drug_response_data.         If string, it is the column name of drugs.</p></li>
<li><p><strong>prediction_power_measure</strong> (<em>string</em>) – ‘pearson’ uses the absolute value of Pearson correlation coefficient to         measure prediction power of a gene; ‘mutual_info’ uses the mutual information to measure prediction power         of a gene; ‘lm’ uses the linear regression model to select predictive genes for multiple drugs. Default is ‘lm’.</p></li>
<li><p><strong>num_predictive_gene</strong> (<em>int</em>) – the number of predictive genes to be selected.</p></li>
<li><p><strong>generalization_power_measure</strong> (<em>string</em>) – ‘pearson’ indicates the Pearson correlation coefficient;         ‘ccc’ indicates the concordance correlation coefficient. Default is ‘ccc’.</p></li>
<li><p><strong>num_generalizable_gene</strong> (<em>int</em>) – the number of generalizable genes to be selected.</p></li>
<li><p><strong>union_of_single_drug_selection</strong> (<em>bool</em>) – whether the final gene set should be the union of genes         selected for every drug.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1-D numpy array containing the indices of selected genes.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.coxen_single_drug_gene_selection">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">coxen_single_drug_gene_selection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drug_response_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drug_response_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tumor_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_power_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pearson'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_predictive_gene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">generalization_power_measure</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ccc'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_generalizable_gene</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multi_drug_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/P1_utils.html#coxen_single_drug_gene_selection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.coxen_single_drug_gene_selection" title="Permalink to this definition">¶</a></dt>
<dd><p>This function selects genes for drug response prediction using the COXEN
approach. The COXEN approach is designed for selecting genes to predict the
response of tumor cells to a specific drug. This function assumes no
missing data exist.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_data</strong> – pandas data frame of gene expressions of tumors, for which drug response is known.        Its size is [n_source_samples, n_features].</p></li>
<li><p><strong>target_data</strong> – pandas data frame of gene expressions of tumors, for which drug response needs to be predicted.         Its size is [n_target_samples, n_features]. source_data and target_data have the same set         of features and the orders of features must match.</p></li>
<li><p><strong>drug_response_data</strong> – pandas data frame of drug response values for a drug.         It must include a column of drug response values and a column of tumor IDs.</p></li>
<li><p><strong>drug_response_col</strong> – non-negative integer or string. If integer, it is the column index of drug response in         drug_response_data. If string, it is the column name of drug response.</p></li>
<li><p><strong>tumor_col</strong> – non-negative integer or string. If integer, it is the column index of tumor IDs in drug_response_data.         If string, it is the column name of tumor IDs.</p></li>
<li><p><strong>prediction_power_measure</strong> (<em>string</em>) – ‘pearson’ uses the absolute value of Pearson correlation coefficient to         measure prediction power of gene; ‘mutual_info’ uses the mutual information to measure prediction power         of gene. Default is ‘pearson’.</p></li>
<li><p><strong>num_predictive_gene</strong> (<em>int</em>) – the number of predictive genes to be selected.</p></li>
<li><p><strong>generalization_power_measure</strong> (<em>string</em>) – ‘pearson’ indicates the Pearson correlation coefficient;         ‘ccc’ indicates the concordance correlation coefficient. Default is ‘ccc’.</p></li>
<li><p><strong>num_generalizable_gene</strong> (<em>int</em>) – the number of generalizable genes to be selected.     :param bool multi_drug_mode: indicating whether the function runs as an auxiliary function of COXEN         gene selection for multiple drugs. Default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1-D numpy array containing the indices of selected genes, if multi_drug_mode is False;         1-D numpy array of indices of sorting all genes according to their prediction power, if multi_drug_mode is True.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.generate_gene_set_data">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">generate_gene_set_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'entrez'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_set_category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'c6.all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'../../Data/examples/Gene_Sets/MSigDB.v7.0/'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/P1_utils.html#generate_gene_set_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.generate_gene_set_data" title="Permalink to this definition">¶</a></dt>
<dd><p>This function generates genomic data summarized at the gene set level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – numpy array or pandas data frame of numeric values, with a shape of [n_samples, n_features].</p></li>
<li><p><strong>genes</strong> – 1-D array or list of gene names with a length of n_features. It indicates which gene a genomic         feature belongs to.</p></li>
<li><p><strong>gene_name_type</strong> (<em>string</em>) – the type of gene name used in genes. ‘entrez’ indicates Entrez gene ID and         ‘symbols’ indicates HGNC gene symbol. Default is ‘symbols’.</p></li>
<li><p><strong>gene_set_category</strong> (<em>string</em>) – the gene sets for which data will be calculated. ‘c2.cgp’ indicates gene sets         affected by chemical and genetic perturbations; ‘c2.cp.biocarta’ indicates BioCarta gene sets; ‘c2.cp.kegg’         indicates KEGG gene sets; ‘c2.cp.pid’ indicates PID gene sets; ‘c2.cp.reactome’ indicates Reactome gene sets;         ‘c5.bp’ indicates GO biological processes; ‘c5.cc’ indicates GO cellular components; ‘c5.mf’ indicates         GO molecular functions; ‘c6.all’ indicates oncogenic signatures. Default is ‘c6.all’.</p></li>
<li><p><strong>metric</strong> (<em>string</em>) – the way to calculate gene-set-level data. ‘mean’ calculates the mean of gene         features belonging to the same gene set. ‘sum’ calculates the summation of gene features belonging         to the same gene set. ‘max’ calculates the maximum of gene features. ‘min’ calculates the minimum         of gene features. ‘abs_mean’ calculates the mean of absolute values. ‘abs_maximum’ calculates         the maximum of absolute values. Default is ‘mean’.</p></li>
<li><p><strong>standardize</strong> (<em>bool</em>) – whether to standardize features before calculation. Standardization transforms         each feature to have a zero mean and a unit standard deviation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a data frame of calculated gene-set-level data. Column names are the gene set names.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.check_flag_conflicts">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">check_flag_conflicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConfigDict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/parsing_utils.html#check_flag_conflicts"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.check_flag_conflicts" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if parameters that must be exclusive are used in conjunction. The
check is made against CONFLICT_LIST, a global list that describes parameter
pairs that should be exclusive. Raises an exception if pairs of parameters
in CONFLICT_LIST are specified simulataneously.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<em>Dict</em>) – list to extract keywords from</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.finalize_parameters">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">finalize_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bmk</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/parsing_utils.html#finalize_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.finalize_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Utility to parse parameters in common as well as parameters particular
to each benchmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bmk</strong> (<a class="reference internal" href="#candle.Benchmark" title="candle.Benchmark"><em>Benchmark</em></a>) – Object that has benchmark filepaths and specifications</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with all the parameters necessary to run the benchmark.        Command line overwrites config file specifications</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.parse_from_dictlist">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">parse_from_dictlist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictlist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">ParseDict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/parsing_utils.html#parse_from_dictlist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.parse_from_dictlist" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to parse options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pardict</strong> (<em>List</em>) – Specification of parameters</p></li>
<li><p><strong>parser</strong> (<em>ArgumentParser</em>) – Current parser</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>consolidated parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ArgumentParser</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.compute_empirical_calibration_interpolation">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">compute_empirical_calibration_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pSigma_cal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pPred_cal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_cal</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_utils.html#compute_empirical_calibration_interpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.compute_empirical_calibration_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the arrays provided to estimate an empirical mapping between
standard deviation and absolute value of error, both of which have been
observed during inference. Since most of the times the prediction
statistics are very noisy, two smoothing steps (based on scipy’s savgol
filter) are performed. Cubic Hermite splines (PchipInterpolator) are
constructed for interpolation. This type of splines preserves the
monotonicity in the interpolation data and does not overshoot if the data
is not smooth. The overall process of constructing a spline to express the
mapping from standard deviation to error is composed of smoothing-
interpolation-smoothing-interpolation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pSigma_cal</strong> (<em>numpy array</em>) – Part of the standard deviations array to use for calibration.</p></li>
<li><p><strong>pPred_cal</strong> (<em>numpy array</em>) – Part of the predictions array to use for calibration.</p></li>
<li><p><strong>true_cal</strong> (<em>numpy array</em>) – Part of the true (observed) values array to use for calibration.</p></li>
<li><p><strong>cv</strong> (<em>int</em>) – Number of cross validations folds to run to determine a ‘good’ fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of python objects</p>
<ul class="simple">
<li><p>splineobj_best : scipy.interpolate python object             A python object from scipy.interpolate that computes a             cubic Hermite splines (PchipInterpolator) constructed             to express the mapping from standard deviation to error after a             ‘drastic’ smoothing of the predictions. A ‘good’ fit is             determined by taking the spline for the fold that produces             the smaller mean absolute error in testing data (not used             for the smoothing / interpolation).</p></li>
<li><p>splineobj2 : scipy.interpolate python object             A python object from scipy.interpolate that computes a             cubic Hermite splines (PchipInterpolator) constructed             to express the mapping from standard deviation to error. This             spline is generated for interpolating the samples generated             after the smoothing of the first interpolation spline (i.e.             splineobj_best).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.compute_statistics_heteroscedastic">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">compute_statistics_heteroscedastic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_pred_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_std_pred_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/candle/uq_utils.html#compute_statistics_heteroscedastic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.compute_statistics_heteroscedastic" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts ground truth, mean prediction, error, standard deviation of
prediction and predicted (learned) standard deviation from inference data
frame. The latter includes all the individual inference realizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_data</strong> (<em>pandas dataframe</em>) – Data frame generated by current heteroscedastic inference         experiments. Indices are hard coded to agree with         current version. (The inference file usually         has the name: &lt;model&gt;.predicted_INFER_HET.tsv).</p></li>
<li><p><strong>col_true</strong> (<em>int</em>) – Index of the column in the data frame where the true         value is stored (Default: 4, index in current HET format).</p></li>
<li><p><strong>col_pred_start</strong> (<em>int</em>) – Index of the column in the data frame where the first predicted         value is stored. All the predicted values during inference         are stored and are interspaced with standard deviation         predictions (Default: 6 index, step 2, in current HET format).</p></li>
<li><p><strong>col_std_pred_start</strong> (<em>int</em>) – Index of the column in the data frame where the first predicted         standard deviation value is stored. All the predicted values         during inference are stored and are interspaced with predictions         (Default: 7 index, step 2, in current HET format).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of numpy arrays</p>
<ul class="simple">
<li><p>Ytrue (numpy array): Array with true (observed) values</p></li>
<li><p>Ypred_mean (numpy array): Array with predicted values (mean of predictions).</p></li>
<li><p>yerror (numpy array): Array with errors computed (observed - predicted).</p></li>
<li><p>sigma (numpy array): Array with standard deviations learned with deep learning             model. For heteroscedastic inference this corresponds to the             sqrt(exp(s^2)) with s^2 predicted value.</p></li>
<li><p>Ypred_std (numpy array): Array with standard deviations computed from regular             (homoscedastic) inference.</p></li>
<li><p>pred_name (string): Name of data colum or quantity predicted (as extracted             from the data frame using the col_true index).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.compute_statistics_homoscedastic">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">compute_statistics_homoscedastic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_pred_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/candle/uq_utils.html#compute_statistics_homoscedastic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.compute_statistics_homoscedastic" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts ground truth, mean prediction, error and standard deviation of
prediction from inference data frame. The latter includes all the
individual inference realizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_data</strong> (<em>pandas dataframe</em>) – Data frame generated by current CANDLE inference         experiments. Indices are hard coded to agree with         current CANDLE version. (The inference file usually         has the name: &lt;model&gt;.predicted_INFER.tsv).</p></li>
<li><p><strong>col_true</strong> (<em>int</em>) – Index of the column in the data frame where the true         value is stored (Default: 4, index in current HOM format).</p></li>
<li><p><strong>col_pred_start</strong> (<em>int</em>) – Index of the column in the data frame where the first predicted         value is stored. All the predicted values during inference         are stored (Default: 6 index, in current HOM format).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of numpy arrays</p>
<ul class="simple">
<li><p>Ytrue (numpy array): Array with true (observed) values</p></li>
<li><p>Ypred_mean (numpy array): Array with predicted values (mean of predictions).</p></li>
<li><p>yerror (numpy array): Array with errors computed (observed - predicted).</p></li>
<li><p>sigma (numpy array): Array with standard deviations learned with deep learning             model. For homoscedastic inference this corresponds to the             std value computed from prediction (and is equal to the             following returned variable).</p></li>
<li><p>Ypred_std (numpy array): Array with standard deviations computed from regular             (homoscedastic) inference.</p></li>
<li><p>pred_name (string): Name of data colum or quantity predicted (as extracted             from the data frame using the col_true index).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.compute_statistics_homoscedastic_summary">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">compute_statistics_homoscedastic_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_std_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">7</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/candle/uq_utils.html#compute_statistics_homoscedastic_summary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.compute_statistics_homoscedastic_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts ground truth, mean prediction, error and standard deviation of
prediction from inference data frame. The latter includes the statistics
over all the inference realizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_data</strong> (<em>pandas dataframe</em>) – Data frame generated by current CANDLE inference         experiments. Indices are hard coded to agree with         current CANDLE version. (The inference file usually         has the name: &lt;model&gt;_pred.tsv).</p></li>
<li><p><strong>col_true</strong> (<em>int</em>) – Index of the column in the data frame where the true         value is stored (Default: 0, index in current CANDLE format).</p></li>
<li><p><strong>col_pred</strong> (<em>int</em>) – Index of the column in the data frame where the predicted         value is stored (Default: 6, index in current CANDLE format).</p></li>
<li><p><strong>col_std_pred</strong> (<em>int</em>) – Index of the column in the data frame where the standard         deviation of the predicted values is stored (Default: 7,         index in current CANDLE format).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of numpy arrays</p>
<ul class="simple">
<li><p>Ytrue (numpy array): Array with true (observed) values</p></li>
<li><p>Ypred_mean (numpy array): Array with predicted values (mean from summary).</p></li>
<li><p>yerror (numpy array): Array with errors computed (observed - predicted).</p></li>
<li><p>sigma (numpy array): Array with standard deviations learned with deep learning             model. For homoscedastic inference this corresponds to the             std value computed from prediction (and is equal to the             following returned variable).</p></li>
<li><p>Ypred_std (numpy array): Array with standard deviations computed from regular             (homoscedastic) inference.</p></li>
<li><p>pred_name (string): Name of data colum or quantity predicted (as extracted             from the data frame using the col_true index).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.compute_statistics_quantile">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">compute_statistics_quantile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_divisor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2.56</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_true</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_pred_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/candle/uq_utils.html#compute_statistics_quantile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.compute_statistics_quantile" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts ground truth, 50th percentile mean prediction, low percentile
and high percentile mean prediction (usually 1st decile and 9th decile
respectively), error (using 5th decile), standard deviation of prediction
(using 5th decile) and predicted (learned) standard deviation from
interdecile range in inference data frame. The latter includes all the
individual inference realizations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_data</strong> (<em>pandas dataframe</em>) – Data frame generated by current quantile inference         experiments. Indices are hard coded to agree with         current version. (The inference file usually         has the name: &lt;model&gt;.predicted_INFER_QTL.tsv).</p></li>
<li><p><strong>sigma_divisor</strong> (<em>float</em>) – Divisor to convert from the intercedile range to the corresponding         standard deviation for a Gaussian distribution.         (Default: 2.56, consisten with an interdecile range computed from         the difference between the 9th and 1st deciles).</p></li>
<li><p><strong>col_true</strong> (<em>int</em>) – Index of the column in the data frame where the true         value is stored (Default: 4, index in current QTL format).</p></li>
<li><p><strong>col_pred_start</strong> (<em>int</em>) – Index of the column in the data frame where the first predicted         value is stored. All the predicted values during inference         are stored and are interspaced with other percentile         predictions (Default: 6 index, step 3, in current QTL format).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of numpy arrays</p>
<ul class="simple">
<li><p>Ytrue (numpy array): Array with true (observed) values</p></li>
<li><p>Ypred (numpy array): Array with predicted values (based on the 50th percentile).</p></li>
<li><p>yerror (numpy array): Array with errors computed (observed - predicted).</p></li>
<li><p>sigma (numpy array): Array with standard deviations learned with deep learning             model. This corresponds to the interdecile range divided             by the sigma divisor.</p></li>
<li><p>Ypred_std (numpy array): Array with standard deviations computed from regular             (homoscedastic) inference.</p></li>
<li><p>pred_name (string): Name of data colum or quantity predicted (as extracted             from the data frame using the col_true index).</p></li>
<li><p>Ypred_Lp_mean (numpy array): Array with predicted values of the lower percentile             (usually the 1st decile).</p></li>
<li><p>Ypred_Hp_mean (numpy array): Array with predicted values of the higher percentile             (usually the 9th decile).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.generate_index_distribution">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">generate_index_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numTrain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numTest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numValidation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">UQDistDict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/candle/uq_utils.html#generate_index_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.generate_index_distribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a vector of indices to partition the data for training. NO
CHECKING IS DONE: it is assumed that the data could be partitioned in the
specified blocks and that the block indices describe a coherent partition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numTrain</strong> (<em>int</em>) – Number of training data points</p></li>
<li><p><strong>numTest</strong> (<em>int</em>) – Number of testing data points</p></li>
<li><p><strong>numValidation</strong> (<em>int</em>) – Number of validation data points (may be zero)</p></li>
<li><p><strong>params</strong> (<em>Dict</em>) – Contains the keywords that control the behavior of the function         (uq_train_fr, uq_valid_fr, uq_test_fr for fraction specification,         uq_train_vec, uq_valid_vec, uq_test_vec for block list specification, and         uq_train_bks, uq_valid_bks, uq_test_bks for block number specification)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of numpy arrays</p>
<ul class="simple">
<li><p>indexTrain (int numpy array): Indices for data in training</p></li>
<li><p>indexValidation (int numpy array): Indices for data in validation (if any)</p></li>
<li><p>indexTest (int numpy array): Indices for data in testing (if merging)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.split_data_for_empirical_calibration">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">split_data_for_empirical_calibration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ytrue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ypred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cal_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/candle/uq_utils.html#split_data_for_empirical_calibration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.split_data_for_empirical_calibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts a portion of the arrays provided for the computation of the
calibration and reserves the remainder portion for testing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ytrue</strong> (<em>numpy array</em>) – Array with true (observed) values</p></li>
<li><p><strong>Ypred</strong> (<em>numpy array</em>) – Array with predicted values.</p></li>
<li><p><strong>sigma</strong> (<em>numpy array</em>) – Array with standard deviations learned with deep learning         model (or std value computed from prediction if homoscedastic         inference).</p></li>
<li><p><strong>cal_split</strong> (<em>float</em>) – Split of data to use for estimating the calibration relationship.          It is assumet that it will be a value in (0, 1).          (Default: use 80% of predictions to generate empirical calibration).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of numpy arrays</p>
<ul class="simple">
<li><p>index_perm_total (numpy array): Random permutation of the array indices. The first ‘num_cal’             of the indices correspond to the samples that are used for             calibration, while the remainder are the samples reserved             for calibration testing.</p></li>
<li><p>pSigma_cal (numpy array): Part of the input sigma array to use for calibration.</p></li>
<li><p>pSigma_test (numpy array): Part of the input sigma array to reserve for testing.</p></li>
<li><p>pPred_cal (numpy array): Part of the input Ypred array to use for calibration.</p></li>
<li><p>pPred_test (numpy array): Part of the input Ypred array to reserve for testing.</p></li>
<li><p>true_cal (numpy array): Part of the input Ytrue array to use for calibration.</p></li>
<li><p>true_test (numpy array): Part of the input Ytrue array to reserve for testing.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_2d_density_sigma_vs_error">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_2d_density_sigma_vs_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerror</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_2d_density_sigma_vs_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_2d_density_sigma_vs_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to plot a 2D histogram of the distribution of the standard
deviations computed for the predictions vs. the computed errors (i.e. values of observed - predicted).
The plot generated is stored in a png file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<em>numpy array</em>) – Array with standard deviations computed.</p></li>
<li><p><strong>yerror</strong> (<em>numpy array</em>) – Array with errors computed (observed - predicted).</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method used to comput the standard deviations (i.e. dropout, heteroscedastic, etc.).</p></li>
<li><p><strong>figprefix</strong> (<em>string</em>) – String to prefix the filename to store the figure generated.       A ‘_density_sigma_error.png’ string will be appended to the figprefix given.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_array">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_array</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nparray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_array"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_calibrated_std">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_calibrated_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_calibrated</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresC</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_calibrated_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_calibrated_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to plot values in testing set after calibration. An
estimation of the lower-confidence samples is made. The plot generated is
stored in a png file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_test</strong> (<em>numpy array</em>) – Array with (true) observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>numpy array</em>) – Array with predicted values.</p></li>
<li><p><strong>std_calibrated</strong> (<em>numpy array</em>) – Array with standard deviation values after calibration.</p></li>
<li><p><strong>thresC</strong> (<em>float</em>) – Threshold to label low confidence predictions (low       confidence predictions are the ones with std &gt; thresC).</p></li>
<li><p><strong>pred_name</strong> (<em>string</em>) – Name of data colum or quantity predicted (e.g. growth, AUC, etc.).</p></li>
<li><p><strong>figprefix</strong> (<em>string</em>) – String to prefix the filename to store the figure generated.       A ‘_calibrated.png’ string will be appended to the figprefix given.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_calibration_interpolation">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_calibration_interpolation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mean_sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splineobj1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">splineobj2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_calibration_interpolation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_calibration_interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to plot empirical calibration curves estimated by
interpolation of the computed standard deviations and errors. Since the
estimations are very noisy, two levels of smoothing are used. Both can be
plotted independently, if requested. The plot(s) generated is(are) stored
in png file(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mean_sigma</strong> (<em>numpy array</em>) – Array with the mean standard deviations computed in inference.</p></li>
<li><p><strong>error</strong> (<em>numpy array</em>) – Array with the errors computed from the means predicted in inference.</p></li>
<li><p><strong>splineobj1</strong> (<em>scipy.interpolate python object</em>) – A python object from scipy.interpolate that computes a       cubic Hermite spline (PchipInterpolator) to express       the interpolation after the first smoothing. This       spline is a partial result generated during the empirical       calibration procedure.</p></li>
<li><p><strong>splineobj2</strong> (<em>scipy.interpolate python object</em>) – A python object from scipy.interpolate that computes a       cubic Hermite spline (PchipInterpolator) to express       the mapping from standard deviation to error. This       spline is generated for interpolating the predictions       after a process of smoothing-interpolation-smoothing       computed during the empirical calibration procedure.</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method used to comput the standard deviations (i.e. dropout, heteroscedastic, etc.).</p></li>
<li><p><strong>figprefix</strong> (<em>string</em>) – String to prefix the filename to store the figure generated.       A ‘_empirical_calibration_interpolation.png’ string will be appended to the figprefix given.</p></li>
<li><p><strong>steps</strong> (<em>bool</em>) – Besides the complete empirical calibration (including the interpolating       spline), also generates partial plots with only the spline of       the interpolating spline after the first smoothing level (smooth1).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_contamination">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_contamination</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_contamination"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_contamination" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to plot results for the contamination model. This includes
the latent variables T if they are given (i.e. if the results provided
correspond to training results). Global parameters for the normal
distribution are used for shading 80% confidence interval. If results for
training (i.e. T available), samples determined to be outliers (i.e.
samples whose probability of membership to the heavy tailed distribution
(Cauchy) is greater than the threshold given) are highlighted. The plot(s)
generated is(are) stored in a png file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_true</strong> (<em>numpy array</em>) – Array with observed values.</p></li>
<li><p><strong>y_pred</strong> (<em>numpy array</em>) – Array with predicted values.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Standard deviation of the normal distribution.</p></li>
<li><p><strong>T</strong> (<em>numpy array</em>) – Array with latent variables (i.e. membership to normal and heavy-tailed       distributions). If in testing T is not available (i.e. None)</p></li>
<li><p><strong>thresC</strong> (<em>float</em>) – Threshold to label outliers (outliers are the ones       with probability of membership to heavy-tailed distribution, i.e. T[:,1] &gt; thresC).</p></li>
<li><p><strong>pred_name</strong> (<em>string</em>) – Name of data colum or quantity predicted (e.g. growth, AUC, etc.).</p></li>
<li><p><strong>figprefix</strong> (<em>string</em>) – String to prefix the filename to store the figures generated.       A ‘_contamination.png’ string will be appended to the figprefix given.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_decile_predictions">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_decile_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ypred_Lp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ypred_Hp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decile_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_decile_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_decile_predictions" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to plot the mean of the deciles predicted. The plot
generated is stored in a png file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ypred</strong> (<em>numpy array</em>) – Array with median predicted values.</p></li>
<li><p><strong>Ypred_Lp</strong> (<em>numpy array</em>) – Array with low decile predicted values.</p></li>
<li><p><strong>Ypred_Hp</strong> (<em>numpy array</em>) – Array with high decile predicted values.</p></li>
<li><p><strong>decile_list</strong> (<em>List</em>) – List of deciles predicted (e.g. ‘1st’, ‘9th’, etc.)</p></li>
<li><p><strong>pred_name</strong> (<em>string</em>) – Name of data colum or quantity predicted (e.g. growth, AUC, etc.)</p></li>
<li><p><strong>figprefix</strong> (<em>string</em>) – String to prefix the filename to store the figure generated.       A ‘_decile_predictions.png’ string will be appended to the figprefix given.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_density_observed_vs_predicted">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_density_observed_vs_predicted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Ytest</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ypred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pred_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_density_observed_vs_predicted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_density_observed_vs_predicted" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to plot a 2D histogram of the distribution of observed
(ground truth) values vs. predicted values. The plot generated is stored in
a png file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ytest</strong> (<em>numpy array</em>) – Array with (true) observed values</p></li>
<li><p><strong>Ypred</strong> (<em>numpy array</em>) – Array with predicted values.</p></li>
<li><p><strong>pred_name</strong> (<em>string</em>) – Name of data colum or quantity predicted (e.g. growth, AUC, etc.)</p></li>
<li><p><strong>figprefix</strong> (<em>string</em>) – String to prefix the filename to store the figure generated.
A ‘_density_predictions.png’ string will be appended to the figprefix given.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_histogram_error_per_sigma">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_histogram_error_per_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yerror</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figprefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_histogram_error_per_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_histogram_error_per_sigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to plot a 1D histogram of the distribution of computed errors
(i.e. values of observed - predicted) observed
for specific values of standard deviations computed. The range of
standard deviations computed is split in xbins values and the
1D histograms of error distributions for the smallest six
standard deviations are plotted.
The plot generated is stored in a png file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<em>numpy array</em>) – Array with standard deviations computed.</p></li>
<li><p><strong>yerror</strong> (<em>numpy array</em>) – Array with errors computed (observed - predicted).</p></li>
<li><p><strong>method</strong> (<em>string</em>) – Method used to comput the standard deviations (i.e. dropout, heteroscedastic, etc.).</p></li>
<li><p><strong>figprefix</strong> (<em>string</em>) – String to prefix the filename to store the figure generated.      A ‘_histogram_error_per_sigma.png’ string will be appended to the figprefix given.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_history">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_history" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_scatter">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_scatter" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.clr_callback">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">clr_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.999994</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callback</span></span></span><a class="reference internal" href="../_modules/candle/clr_keras_utils.html#clr_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.clr_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates keras callback for cyclical learning rate.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.clr_check_args">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">clr_check_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="reference internal" href="../_modules/candle/clr_keras_utils.html#clr_check_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.clr_check_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the arguments for cyclical learning rate are valid.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.clr_set_args">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">clr_set_args</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span></span></span><a class="reference internal" href="../_modules/candle/clr_keras_utils.html#clr_set_args"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.clr_set_args" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.build_initializer">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">build_initializer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initializer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kerasDefaults</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#build_initializer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.build_initializer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the initializer to the appropriate Keras initializer function based
on the input string and learning rate. Other required values are set to the
Keras default values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>initializer</strong> (<em>string</em>) – String to choose the initializer         Options recognized: ‘constant’, ‘uniform’, ‘normal’,         ‘glorot_uniform’, ‘lecun_uniform’, ‘he_normal’         See the Keras documentation for a full description of the options</p></li>
<li><p><strong>kerasDefaults</strong> (<em>List</em>) – List of default parameter values to ensure consistency between frameworks</p></li>
<li><p><strong>seed</strong> (<em>int</em>) – Random number seed</p></li>
<li><p><strong>constant</strong> (<em>float</em>) – Constant value (for the constant initializer only)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The appropriate Keras initializer function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.build_optimizer">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kerasDefaults</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#build_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.build_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the optimizer to the appropriate Keras optimizer function based on
the input string and learning rate. Other required values are set to the
Keras default values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> (<em>string</em>) – String to choose the optimizer         Options recognized: ‘sgd’, ‘rmsprop’, ‘adagrad’, adadelta’, ‘adam’         See the Keras documentation for a full description of the options</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – Learning rate</p></li>
<li><p><strong>kerasDefaults</strong> (<em>List</em>) – List of default parameter values to ensure consistency between frameworks</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The appropriate Keras optimizer function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.compute_trainable_params">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">compute_trainable_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#compute_trainable_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.compute_trainable_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract number of parameters from the given Keras model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – Keras model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>python dictionary that contains trainable_params, non_trainable_params and total_params</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.get_function">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">get_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#get_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.get_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.mae">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">mae</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#mae"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.mae" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.mse">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.mse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.r2">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">r2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#r2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.r2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.register_permanent_dropout">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">register_permanent_dropout</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#register_permanent_dropout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.register_permanent_dropout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.set_parallelism_threads">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">set_parallelism_threads</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#set_parallelism_threads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.set_parallelism_threads" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the number of parallel threads according to the number available on
the hardware.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.set_seed">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.set_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random number seed to the desired value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>int</em>) – Random number seed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.abstention_acc_class_i_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">abstention_acc_class_i_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#abstention_acc_class_i_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.abstention_acc_class_i_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate accuracy over the class i prediction after removing
the samples where the model is abstaining.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb_classes</strong> (<em>int</em><em> or </em><em>ndarray</em>) – Integer or numpy array defining indices of the abstention class</p></li>
<li><p><strong>class_i</strong> (<em>int</em>) – Index of the class to estimate accuracy after removing abstention samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.abstention_acc_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">abstention_acc_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#abstention_acc_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.abstention_acc_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstained accuracy: Function to estimate accuracy over the predicted
samples after removing the samples where the model is abstaining.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nb_classes</strong> (<em>int</em><em> or </em><em>ndarray</em>) – Integer or numpy array defining indices of the abstention class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.abstention_class_i_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">abstention_class_i_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#abstention_class_i_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.abstention_class_i_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate fraction of the samples where the model is
abstaining in class i.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nb_classes</strong> (<em>int</em><em> or </em><em>ndarray</em>) – Integer or numpy array defining indices of the abstention class</p></li>
<li><p><strong>class_i</strong> (<em>int</em>) – Index of the class to estimate accuracy</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.abstention_loss">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">abstention_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#abstention_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.abstention_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute abstention loss. It is composed by two terms: (i)
original loss of the multiclass classification problem, (ii) cost
associated to the abstaining samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> – Keras variable. Weight of abstention term in cost function</p></li>
<li><p><strong>mask</strong> (<em>ndarray</em>) – Numpy array to use as mask for abstention:         it is 1 on the output associated to the abstention class and 0 otherwise</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.abstention_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">abstention_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#abstention_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.abstention_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate fraction of the samples where the model is
abstaining.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nb_classes</strong> (<em>int</em><em> or </em><em>ndarray</em>) – Integer or numpy array defining indices of the abstention class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.acc_class_i_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">acc_class_i_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_i</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#acc_class_i_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.acc_class_i_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to estimate accuracy over the ith class prediction. This
estimation is global (i.e. abstaining samples are not removed)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>class_i</strong> (<em>int</em>) – Index of the class to estimate accuracy</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.add_index_to_output">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">add_index_to_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#add_index_to_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.add_index_to_output" title="Permalink to this definition">¶</a></dt>
<dd><p>This function adds a column to the training output to store the indices
of the corresponding samples in the training set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>y_train</strong> (<em>ndarray</em>) – Numpy array of the output in the training set</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.add_model_output">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">add_model_output</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">modelIn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_add</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#add_model_output"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.add_model_output" title="Permalink to this definition">¶</a></dt>
<dd><p>This function modifies the last dense layer in the passed keras model.
The modification includes adding units and optionally changing the
activation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>modelIn</strong> – keras model. Keras model to be modified.</p></li>
<li><p><strong>mode</strong> (<em>string</em>) – <p>Mode to modify the layer. It could be:</p>
<ul>
<li><p>’abstain’ for adding an arbitrary number of units for the abstention optimization strategy.</p></li>
<li><p>’qtl’ for quantile regression which needs the outputs to be tripled.</p></li>
<li><p>’het’ for heteroscedastic regression which needs the outputs to be doubled.</p></li>
</ul>
</p></li>
<li><p><strong>num_add</strong> (<em>int</em>) – Number of units to add. This only applies to the ‘abstain’ mode.</p></li>
<li><p><strong>activation</strong> (<em>string</em>) – String with keras specification of activation function (e.g. ‘relu’, ‘sigomid’, ‘softmax’, etc.)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Keras model after last dense layer has been modified as specified.         If there is no mode specified it returns the same model.         If the mode is not one of ‘abstain’, ‘qtl’ or ‘het’ an exception is raised.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Keras model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.contamination_loss">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">contamination_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigmaSQ</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gammaSQ</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#contamination_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.contamination_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute contamination loss. It is composed by two terms: (i)
the loss with respect to the normal distribution that models the
distribution of the training data samples, (ii) the loss with respect to
the Cauchy distribution that models the distribution of the outlier
samples. Note that the evaluation of this contamination loss function does
not make sense for any data different to the training set. This is because
latent variables are only defined for samples in the training set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation (in the contamination model         the augmentation corresponds to the data index in training).</p></li>
<li><p><strong>T_k</strong> – Keras tensor. Tensor containing latent variables (probability of membership         to normal and Cauchy distributions) for each of the samples in the training set.         (Validation data is usually augmented too to be able to run training with validation set,         however loss in validation should not be used as a criterion for early stopping training         since the latent variables are defined for the training only, and thus, are not valid         when used in combination with data different from training).</p></li>
<li><p><strong>a</strong> – Keras variable. Probability of belonging to the normal distribution</p></li>
<li><p><strong>sigmaSQ</strong> – Keras variable. Variance estimated for the normal distribution</p></li>
<li><p><strong>gammaSQ</strong> – Keras variable. Scale estimated for the Cauchy distribution</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.heteroscedastic_loss">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">heteroscedastic_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#heteroscedastic_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.heteroscedastic_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the heteroscedastic loss for the heteroscedastic
model. Both mean and standard deviation predictions are taken into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.mae_contamination_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">mae_contamination_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#mae_contamination_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.mae_contamination_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the mean absolute error (mae) for the
contamination model. The mae is computed over the prediction. Therefore,
the augmentation for the index variable is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation (in the contamination model the augmentation corresponds to the data index in training).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.mae_heteroscedastic_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">mae_heteroscedastic_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#mae_heteroscedastic_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.mae_heteroscedastic_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the mean absolute error (mae) for the
heteroscedastic model. The mae is computed over the prediction of the mean
and the standard deviation prediction is not taken into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.meanS_heteroscedastic_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">meanS_heteroscedastic_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#meanS_heteroscedastic_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.meanS_heteroscedastic_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the mean log of the variance (log S) for the
heteroscedastic model. The mean log is computed over the standard deviation
prediction and the mean prediction is not taken into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.modify_labels">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">modify_labels</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">numclasses_out</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytrain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ytest</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yval</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#modify_labels"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.modify_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>This function generates a categorical representation with a class added
for indicating abstention.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>numclasses_out</strong> (<em>int</em>) – Original number of classes + 1 abstention class</p></li>
<li><p><strong>ytrain</strong> (<em>ndarray</em>) – Numpy array of the classes (labels) in the training set</p></li>
<li><p><strong>ytest</strong> (<em>ndarray</em>) – Numpy array of the classes (labels) in the testing set</p></li>
<li><p><strong>yval</strong> (<em>ndarray</em>) – Numpy array of the classes (labels) in the validation set</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.mse_contamination_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">mse_contamination_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#mse_contamination_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.mse_contamination_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the mean squared error (mse) for the
contamination model. The mse is computed over the prediction. Therefore,
the augmentation for the index variable is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation (in the contamination model the augmentation corresponds to the data index in training).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.mse_heteroscedastic_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">mse_heteroscedastic_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#mse_heteroscedastic_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.mse_heteroscedastic_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the mean squared error (mse) for the
heteroscedastic model. The mse is computed over the prediction of the mean
and the standard deviation prediction is not taken into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.quantile_loss">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">quantile_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#quantile_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.quantile_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the quantile loss for a given quantile fraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>quantile</strong> – float in (0, 1). Quantile fraction to compute the loss.</p></li>
<li><p><strong>y_true</strong> – Keras tensor. Keras tensor including the ground truth</p></li>
<li><p><strong>y_pred</strong> – Keras tensor. Keras tensor including the predictions of a quantile model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.quantile_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">quantile_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#quantile_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.quantile_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the quantile metric for a given quantile and
corresponding output index. This is provided as a metric to track evolution
while training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation</p></li>
<li><p><strong>index</strong> (<em>int</em>) – Index of output corresponding to the given quantile.</p></li>
<li><p><strong>quantile</strong> – float in (0, 1). Fraction corresponding to the quantile</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.r2_contamination_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">r2_contamination_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#r2_contamination_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.r2_contamination_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the r2 for the contamination model. The r2 is
computed over the prediction. Therefore, the augmentation for the index
variable is ignored.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation (in the contamination model the augmentation corresponds to the data index in training).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.r2_heteroscedastic_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">r2_heteroscedastic_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#r2_heteroscedastic_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.r2_heteroscedastic_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the r2 for the heteroscedastic model. The r2 is
computed over the prediction of the mean and the standard deviation
prediction is not taken into account.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.sparse_abstention_acc_metric">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">sparse_abstention_acc_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nb_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#sparse_abstention_acc_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.sparse_abstention_acc_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstained accuracy: Function to estimate accuracy over the predicted
samples after removing the samples where the model is abstaining. Assumes
y_true is not one-hot encoded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>nb_classes</strong> (<em>int</em><em> or </em><em>ndarray</em>) – Integer or numpy array defining indices of the abstention class</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.sparse_abstention_loss">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">sparse_abstention_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Type</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#sparse_abstention_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.sparse_abstention_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute abstention loss. It is composed by two terms: (i)
original loss of the multiclass classification problem, (ii) cost
associated to the abstaining samples. Assumes y_true is not one-hot
encoded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> – Keras variable.  Weight of abstention term in cost function</p></li>
<li><p><strong>mask</strong> (<em>ndarray</em>) – Numpy array to use as mask for abstention: it is 1 on the output associated         to the abstention class and 0 otherwise</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.triple_quantile_loss">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">triple_quantile_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowquantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highquantile</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#triple_quantile_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.triple_quantile_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>This function computes the quantile loss for the median and low and high
quantiles. The median is given twice the weight of the other components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nout</strong> (<em>int</em>) – Number of outputs without uq augmentation</p></li>
<li><p><strong>lowquantile</strong> – float in (0, 1). Fraction corresponding to the low quantile</p></li>
<li><p><strong>highquantile</strong> – float in (0, 1). Fraction corresponding to the high quantile</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.plot_metrics">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">plot_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_ep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/viz_utils.html#plot_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.plot_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots keras training curves history.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>skip_ep: number of epochs to skip when plotting metrics
add_lr: add curve of learning rate progression over epochs</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.build_pytorch_activation">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">build_pytorch_activation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">activation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/pytorch_utils.html#build_pytorch_activation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.build_pytorch_activation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.build_pytorch_optimizer">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">build_pytorch_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kerasDefaults</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trainable_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/pytorch_utils.html#build_pytorch_optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.build_pytorch_optimizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.get_pytorch_function">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">get_pytorch_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/pytorch_utils.html#get_pytorch_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.get_pytorch_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.pytorch_initialize">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">pytorch_initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initializer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kerasDefaults</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/pytorch_utils.html#pytorch_initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.pytorch_initialize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.pytorch_mse">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">pytorch_mse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/pytorch_utils.html#pytorch_mse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.pytorch_mse" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.pytorch_xent">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">pytorch_xent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_pred</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/pytorch_utils.html#pytorch_xent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.pytorch_xent" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.set_pytorch_seed">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">set_pytorch_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/pytorch_utils.html#set_pytorch_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.set_pytorch_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the random number seed to the desired value</p>
<section id="parameters">
<h3>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading">¶</a></h3>
<dl class="simple">
<dt>seed<span class="classifier">integer</span></dt><dd><p>Random number seed.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="candle.set_pytorch_threads">
<span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">set_pytorch_threads</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/pytorch_utils.html#set_pytorch_threads"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.set_pytorch_threads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="classes">
<h2><a class="toc-backref" href="#id6">Classes</a><a class="headerlink" href="#classes" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#candle.Benchmark" title="candle.Benchmark"><code class="xref py py-class docutils literal notranslate"><span class="pre">Benchmark</span></code></a>:
Class that implements an interface to handle configuration options for</p></li>
<li><p><a class="reference internal" href="#candle.Progbar" title="candle.Progbar"><code class="xref py py-class docutils literal notranslate"><span class="pre">Progbar</span></code></a>:
Progress bar</p></li>
<li><p><a class="reference internal" href="#candle.ArgumentStruct" title="candle.ArgumentStruct"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentStruct</span></code></a>:
Class that converts a python dictionary into an object with named</p></li>
<li><p><a class="reference internal" href="#candle.MultiGPUCheckpoint" title="candle.MultiGPUCheckpoint"><code class="xref py py-class docutils literal notranslate"><span class="pre">MultiGPUCheckpoint</span></code></a>:
Callback to save the Keras model or model weights at some frequency.</p></li>
<li><p><a class="reference internal" href="#candle.CyclicLR" title="candle.CyclicLR"><code class="xref py py-class docutils literal notranslate"><span class="pre">CyclicLR</span></code></a>:
This callback implements a cyclical learning rate policy (CLR). The</p></li>
<li><p><a class="reference internal" href="#candle.CandleRemoteMonitor" title="candle.CandleRemoteMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">CandleRemoteMonitor</span></code></a>:
Capture Run level output and store/send for monitoring.</p></li>
<li><p><a class="reference internal" href="#candle.LoggingCallback" title="candle.LoggingCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">LoggingCallback</span></code></a>:
Abstract base class used to build new callbacks.</p></li>
<li><p><a class="reference internal" href="#candle.PermanentDropout" title="candle.PermanentDropout"><code class="xref py py-class docutils literal notranslate"><span class="pre">PermanentDropout</span></code></a>:
Applies Dropout to the input.</p></li>
<li><p><a class="reference internal" href="#candle.TerminateOnTimeOut" title="candle.TerminateOnTimeOut"><code class="xref py py-class docutils literal notranslate"><span class="pre">TerminateOnTimeOut</span></code></a>:
This class implements timeout on model training.</p></li>
<li><p><a class="reference internal" href="#candle.AbstentionAdapt_Callback" title="candle.AbstentionAdapt_Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstentionAdapt_Callback</span></code></a>:
This callback is used to adapt the parameter alpha in the abstention</p></li>
<li><p><a class="reference internal" href="#candle.Contamination_Callback" title="candle.Contamination_Callback"><code class="xref py py-class docutils literal notranslate"><span class="pre">Contamination_Callback</span></code></a>:
This callback is used to update the parameters of the contamination</p></li>
</ul>
<dl class="py class">
<dt class="sig sig-object py" id="candle.Benchmark">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">Benchmark</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">defmodel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">framework</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prog</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">desc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parser</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">additional_definitions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">required</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/benchmark_def.html#Benchmark"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Benchmark" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that implements an interface to handle configuration options for
the different CANDLE benchmarks.</p>
<p>It provides access to all the common configuration options and
configuration options particular to each individual benchmark. It
describes what minimum requirements should be specified to
instantiate the corresponding benchmark. It interacts with the
argparser to extract command-line options and arguments from the
benchmark’s configuration files.</p>
<p class="rubric">Inheritance</p>
digraph inheritance4a5c9e4366 {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;Benchmark&quot; [URL=&quot;#candle.Benchmark&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;,tooltip=&quot;Class that implements an interface to handle configuration options for&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.Benchmark.check_required_exists">
<span class="sig-name descname"><span class="pre">check_required_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConfigDict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/candle/benchmark_def.html#Benchmark.check_required_exists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Benchmark.check_required_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to verify that the required model parameters have been
specified.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.Benchmark.format_benchmark_config_arguments">
<span class="sig-name descname"><span class="pre">format_benchmark_config_arguments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dictfileparam</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ConfigDict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ConfigDict</span></span></span><a class="reference internal" href="../_modules/candle/benchmark_def.html#Benchmark.format_benchmark_config_arguments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Benchmark.format_benchmark_config_arguments" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to format the particular parameters of the benchmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dictfileparam</strong> (<em>ConfigDict</em>) – parameters read from configuration file</p>
</dd>
<dt class="field-even">Return args</dt>
<dd class="field-even"><p>parameters read from command-line
Most of the time command-line overwrites configuration file
except when the command-line is using default values and
config file defines those values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ConfigDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.Benchmark.get_parameter_from_file">
<span class="sig-name descname"><span class="pre">get_parameter_from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">absfname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/benchmark_def.html#Benchmark.get_parameter_from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Benchmark.get_parameter_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to extract the value of one parameter from the configuration file given. Execution is terminated if the parameter specified is not found in the configuration file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>absfname</strong> (<em>string</em>) – filename of the the configuration file including absolute path.</p></li>
<li><p><strong>param</strong> (<em>string</em>) – parameter to extract from configuration file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a string with the value of the parameter read from the configuration file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.Benchmark.parse_parameters">
<span class="sig-name descname"><span class="pre">parse_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/candle/benchmark_def.html#Benchmark.parse_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Benchmark.parse_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to parse options common for all benchmarks.</p>
<p>This functionality is based on methods ‘get_default_neon_parser’
and ‘get_common_parser’ which are defined previously(above). If
the order changes or they are moved, the calling has to be
updated.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.Benchmark.read_config_file">
<span class="sig-name descname"><span class="pre">read_config_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ConfigDict</span></span></span><a class="reference internal" href="../_modules/candle/benchmark_def.html#Benchmark.read_config_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Benchmark.read_config_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to read the configue file specific for each
benchmark.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<em>string</em>) – path to the configuration file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameters read from configuration file</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ConfigDict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.Benchmark.set_locals">
<span class="sig-name descname"><span class="pre">set_locals</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/benchmark_def.html#Benchmark.set_locals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Benchmark.set_locals" title="Permalink to this definition">¶</a></dt>
<dd><p>Functionality to set variables specific for the benchmark.</p>
<ul class="simple">
<li><p>required: set of required parameters for the benchmark.</p></li>
<li><p>additional_definitions: list of dictionaries describing             the additional parameters for the benchmark.</p></li>
</ul>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.Progbar">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">Progbar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/generic_utils.html#Progbar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Progbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Progress bar</p>
<p class="rubric">Inheritance</p>
digraph inheritance3f45136383 {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;Progbar&quot; [URL=&quot;#candle.Progbar&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;,tooltip=&quot;Progress bar&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.Progbar.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">current</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/generic_utils.html#Progbar.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Progbar.update" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>current</strong> (<em>int</em>) – index of current step</p></li>
<li><p><strong>values</strong> (<em>List</em>) – list of tuples (name, value_for_last_step).             The progress bar will display averages for these values.</p></li>
<li><p><strong>force</strong> (<em>bool</em>) – force visual progress update</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.ArgumentStruct">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">ArgumentStruct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">entries</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/parsing_utils.html#ArgumentStruct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.ArgumentStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that converts a python dictionary into an object with named
entries given by the dictionary keys.</p>
<p>This structure simplifies the calling convention for accessing the
dictionary values (corresponding to problem parameters). After the
object instantiation both modes of access (dictionary or object
entries) can be used.</p>
<p class="rubric">Inheritance</p>
digraph inheritancede336c108e {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;ArgumentStruct&quot; [URL=&quot;#candle.ArgumentStruct&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;,tooltip=&quot;Class that converts a python dictionary into an object with named&quot;];
}
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.MultiGPUCheckpoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">MultiGPUCheckpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monitor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'val_loss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_best_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_weights_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'epoch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_value_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/ckpt_keras_utils.html#MultiGPUCheckpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.MultiGPUCheckpoint" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Inheritance</p>
digraph inheritance4215683b1a {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;Callback&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Abstract base class used to build new callbacks.&quot;];
  &quot;ModelCheckpoint&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Callback to save the Keras model or model weights at some frequency.&quot;];
  &quot;Callback&quot; -&gt; &quot;ModelCheckpoint&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;MultiGPUCheckpoint&quot; [URL=&quot;#candle.MultiGPUCheckpoint&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;];
  &quot;ModelCheckpoint&quot; -&gt; &quot;MultiGPUCheckpoint&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
}
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.CyclicLR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">CyclicLR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_lr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.006</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'triangular'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cycle'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/clr_keras_utils.html#CyclicLR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CyclicLR" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback implements a cyclical learning rate policy (CLR). The
method cycles the learning rate between two boundaries with some constant
frequency.</p>
<ul class="simple">
<li><p>base_lr: initial learning rate which is the lower boundary in the cycle.</p></li>
<li><p>max_lr: upper boundary in the cycle. Functionally, it defines the cycle amplitude (max_lr - base_lr).         The lr at any cycle is the sum of base_lr and some scaling of the amplitude; therefore         max_lr may not actually be reached depending on scaling function.</p></li>
<li><p>step_size: number of training iterations per half cycle. Authors suggest setting step_size         2-8 x training iterations in epoch.</p></li>
<li><p>mode: one of {triangular, triangular2, exp_range}.  Default ‘triangular’.         Values correspond to policies detailed above. If scale_fn is not None, this argument is ignored.</p></li>
<li><p>gamma: constant in ‘exp_range’ scaling function: gamma**(cycle iterations)</p></li>
<li><p>scale_fn: Custom scaling policy defined by a single argument lambda function, where         0 &lt;= scale_fn(x) &lt;= 1 for all x &gt;= 0. mode paramater is ignored</p></li>
<li><p>scale_mode: {‘cycle’, ‘iterations’}.  Defines whether scale_fn is evaluated on             cycle number or cycle iterations (training iterations since start of cycle). Default is ‘cycle’.</p></li>
</ul>
<p>The amplitude of the cycle can be scaled on a per-iteration or per-cycle basis.
This class has three built-in policies, as put forth in the paper.</p>
<ul class="simple">
<li><p>“triangular”: A basic triangular cycle w/ no amplitude scaling.</p></li>
<li><p>“triangular2”: A basic triangular cycle that scales initial amplitude by half each cycle.</p></li>
<li><p>“exp_range”: A cycle that scales initial amplitude by gamma**(cycle iterations) at each cycle iteration.</p></li>
</ul>
<p>For more detail, please see paper.</p>
<p># Example for CIFAR-10 w/ batch size 100:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clr</span> <span class="o">=</span> <span class="n">CyclicLR</span><span class="p">(</span><span class="n">base_lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">0.006</span><span class="p">,</span>
               <span class="n">step_size</span><span class="o">=</span><span class="mf">2000.</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;triangular&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">clr</span><span class="p">])</span>
</pre></div>
</div>
<p>Class also supports custom scaling functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clr_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">2.</span><span class="p">))</span>
<span class="n">clr</span> <span class="o">=</span> <span class="n">CyclicLR</span><span class="p">(</span><span class="n">base_lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">max_lr</span><span class="o">=</span><span class="mf">0.006</span><span class="p">,</span>
               <span class="n">step_size</span><span class="o">=</span><span class="mf">2000.</span><span class="p">,</span> <span class="n">scale_fn</span><span class="o">=</span><span class="n">clr_fn</span><span class="p">,</span>
               <span class="n">scale_mode</span><span class="o">=</span><span class="s1">&#39;cycle&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">clr</span><span class="p">])</span>
</pre></div>
</div>
<p># References</p>
<blockquote>
<div><ul class="simple">
<li><p>[Cyclical Learning Rates for Training Neural Networks](<a class="reference external" href="https://arxiv.org/abs/1506.01186">https://arxiv.org/abs/1506.01186</a>)</p></li>
</ul>
</div></blockquote>
<p class="rubric">Inheritance</p>
digraph inheritance2850616bfe {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;Callback&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Abstract base class used to build new callbacks.&quot;];
  &quot;CyclicLR&quot; [URL=&quot;#candle.CyclicLR&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;,tooltip=&quot;This callback implements a cyclical learning rate policy (CLR). The&quot;];
  &quot;Callback&quot; -&gt; &quot;CyclicLR&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.CyclicLR.on_batch_end">
<span class="sig-name descname"><span class="pre">on_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/clr_keras_utils.html#CyclicLR.on_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CyclicLR.on_batch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>A backwards compatibility alias for <cite>on_train_batch_end</cite>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.CyclicLR.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/clr_keras_utils.html#CyclicLR.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CyclicLR.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should
only be called during TRAIN mode.</p>
<dl>
<dt>Args:</dt><dd><p>epoch: Integer, index of epoch.
logs: Dict, metric results for this training epoch, and for the</p>
<blockquote>
<div><p>validation epoch if validation is performed. Validation result
keys are prefixed with <cite>val_</cite>. For training epoch, the values of
the <cite>Model</cite>’s metrics are returned. Example:
<cite>{‘loss’: 0.2, ‘accuracy’: 0.7}</cite>.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.CyclicLR.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/clr_keras_utils.html#CyclicLR.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CyclicLR.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the beginning of training.</p>
<p>Subclasses should override for any actions to run.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>logs: Dict. Currently no data is passed to this argument for this</dt><dd><p>method but that may change in the future.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.CandleRemoteMonitor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">CandleRemoteMonitor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#CandleRemoteMonitor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CandleRemoteMonitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Capture Run level output and store/send for monitoring.</p>
<p class="rubric">Inheritance</p>
digraph inheritancedd3c1641c7 {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;Callback&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Abstract base class used to build new callbacks.&quot;];
  &quot;CandleRemoteMonitor&quot; [URL=&quot;#candle.CandleRemoteMonitor&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;,tooltip=&quot;Capture Run level output and store/send for monitoring.&quot;];
  &quot;Callback&quot; -&gt; &quot;CandleRemoteMonitor&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.CandleRemoteMonitor.on_epoch_begin">
<span class="sig-name descname"><span class="pre">on_epoch_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#CandleRemoteMonitor.on_epoch_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CandleRemoteMonitor.on_epoch_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the start of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should
only be called during TRAIN mode.</p>
<dl>
<dt>Args:</dt><dd><p>epoch: Integer, index of epoch.
logs: Dict. Currently no data is passed to this argument for this</p>
<blockquote>
<div><p>method but that may change in the future.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.CandleRemoteMonitor.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#CandleRemoteMonitor.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CandleRemoteMonitor.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should
only be called during TRAIN mode.</p>
<dl>
<dt>Args:</dt><dd><p>epoch: Integer, index of epoch.
logs: Dict, metric results for this training epoch, and for the</p>
<blockquote>
<div><p>validation epoch if validation is performed. Validation result
keys are prefixed with <cite>val_</cite>. For training epoch, the values of
the <cite>Model</cite>’s metrics are returned. Example:
<cite>{‘loss’: 0.2, ‘accuracy’: 0.7}</cite>.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.CandleRemoteMonitor.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#CandleRemoteMonitor.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CandleRemoteMonitor.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the beginning of training.</p>
<p>Subclasses should override for any actions to run.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>logs: Dict. Currently no data is passed to this argument for this</dt><dd><p>method but that may change in the future.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.CandleRemoteMonitor.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#CandleRemoteMonitor.on_train_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CandleRemoteMonitor.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of training.</p>
<p>Subclasses should override for any actions to run.</p>
<dl class="simple">
<dt>Args:</dt><dd><dl class="simple">
<dt>logs: Dict. Currently the output of the last call to</dt><dd><p><cite>on_epoch_end()</cite> is passed to this argument for this method but
that may change in the future.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.CandleRemoteMonitor.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#CandleRemoteMonitor.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.CandleRemoteMonitor.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save log_messages to file.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.LoggingCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">LoggingCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_fcn=&lt;built-in</span> <span class="pre">function</span> <span class="pre">print&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#LoggingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.LoggingCallback" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Inheritance</p>
digraph inheritance7a76597093 {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;Callback&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Abstract base class used to build new callbacks.&quot;];
  &quot;LoggingCallback&quot; [URL=&quot;#candle.LoggingCallback&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;];
  &quot;Callback&quot; -&gt; &quot;LoggingCallback&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.LoggingCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#LoggingCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.LoggingCallback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called at the end of an epoch.</p>
<p>Subclasses should override for any actions to run. This function should
only be called during TRAIN mode.</p>
<dl>
<dt>Args:</dt><dd><p>epoch: Integer, index of epoch.
logs: Dict, metric results for this training epoch, and for the</p>
<blockquote>
<div><p>validation epoch if validation is performed. Validation result
keys are prefixed with <cite>val_</cite>. For training epoch, the values of
the <cite>Model</cite>’s metrics are returned. Example:
<cite>{‘loss’: 0.2, ‘accuracy’: 0.7}</cite>.</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.PermanentDropout">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">PermanentDropout</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#PermanentDropout"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.PermanentDropout" title="Permalink to this definition">¶</a></dt>
<dd><p class="rubric">Inheritance</p>
digraph inheritance0e1cb854cd {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;AutoTrackable&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Manages dependencies on other objects.&quot;];
  &quot;Trackable&quot; -&gt; &quot;AutoTrackable&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;BaseRandomLayer&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;A layer handle the random number creation and savemodel behavior.&quot;];
  &quot;Layer&quot; -&gt; &quot;BaseRandomLayer&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;Dropout&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Applies Dropout to the input.&quot;];
  &quot;BaseRandomLayer&quot; -&gt; &quot;Dropout&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;Layer&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;This is the class from which all layers inherit.&quot;];
  &quot;Module&quot; -&gt; &quot;Layer&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;LayerVersionSelector&quot; -&gt; &quot;Layer&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;LayerVersionSelector&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Chooses between Keras v1 and v2 Layer class.&quot;];
  &quot;Module&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Base neural network module class.&quot;];
  &quot;AutoTrackable&quot; -&gt; &quot;Module&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;PermanentDropout&quot; [URL=&quot;#candle.PermanentDropout&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;];
  &quot;Dropout&quot; -&gt; &quot;PermanentDropout&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;Trackable&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Base class for `Trackable` objects without automatic dependencies.&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.PermanentDropout.call">
<span class="sig-name descname"><span class="pre">call</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#PermanentDropout.call"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.PermanentDropout.call" title="Permalink to this definition">¶</a></dt>
<dd><p>This is where the layer’s logic lives.</p>
<p>The <cite>call()</cite> method may not create state (except in its first
invocation, wrapping the creation of variables or other resources in
<cite>tf.init_scope()</cite>).  It is recommended to create state, including
<cite>tf.Variable</cite> instances and nested <cite>Layer</cite> instances,</p>
<blockquote>
<div><p>in <cite>__init__()</cite>, or in the <cite>build()</cite> method that is</p>
</div></blockquote>
<p>called automatically before <cite>call()</cite> executes for the first time.</p>
<dl>
<dt>Args:</dt><dd><dl>
<dt>inputs: Input tensor, or dict/list/tuple of input tensors.</dt><dd><p>The first positional <cite>inputs</cite> argument is subject to special rules:
- <cite>inputs</cite> must be explicitly passed. A layer cannot have zero</p>
<blockquote>
<div><p>arguments, and <cite>inputs</cite> cannot be provided via the default value
of a keyword argument.</p>
</div></blockquote>
<ul class="simple">
<li><p>NumPy array or Python scalar values in <cite>inputs</cite> get cast as
tensors.</p></li>
<li><p>Keras mask metadata is only collected from <cite>inputs</cite>.</p></li>
<li><p>Layers are built (<cite>build(input_shape)</cite> method)
using shape info from <cite>inputs</cite> only.</p></li>
<li><p><cite>input_spec</cite> compatibility is only checked against <cite>inputs</cite>.</p></li>
<li><p>Mixed precision input casting is only applied to <cite>inputs</cite>.
If a layer has tensor arguments in <cite>*args</cite> or <cite>**kwargs</cite>, their
casting behavior in mixed precision should be handled manually.</p></li>
<li><p>The SavedModel input specification is generated using <cite>inputs</cite>
only.</p></li>
<li><p>Integration with various ecosystem packages like TFMOT, TFLite,
TF.js, etc is only supported for <cite>inputs</cite> and not for tensors in
positional and keyword arguments.</p></li>
</ul>
</dd>
<dt><a href="#id1"><span class="problematic" id="id2">*</span></a>args: Additional positional arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.</p>
</dd>
<dt><a href="#id3"><span class="problematic" id="id4">**</span></a>kwargs: Additional keyword arguments. May contain tensors, although</dt><dd><p>this is not recommended, for the reasons above.
The following optional keyword arguments are reserved:
- <cite>training</cite>: Boolean scalar tensor of Python boolean indicating</p>
<blockquote>
<div><p>whether the <cite>call</cite> is meant for training or inference.</p>
</div></blockquote>
<ul class="simple">
<li><p><cite>mask</cite>: Boolean input mask. If the layer’s <cite>call()</cite> method takes a
<cite>mask</cite> argument, its default value will be set to the mask
generated for <cite>inputs</cite> by the previous layer (if <cite>input</cite> did come
from a layer that generated a corresponding mask, i.e. if it came
from a Keras layer with masking support).</p></li>
</ul>
</dd>
</dl>
</dd>
<dt>Returns:</dt><dd><p>A tensor or list/tuple of tensors.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.TerminateOnTimeOut">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">TerminateOnTimeOut</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout_in_sec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#TerminateOnTimeOut"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.TerminateOnTimeOut" title="Permalink to this definition">¶</a></dt>
<dd><p>This class implements timeout on model training.</p>
<p>When the script reaches timeout,
this class sets model.stop_training = True</p>
<p class="rubric">Inheritance</p>
digraph inheritance83191cc935 {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;Callback&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Abstract base class used to build new callbacks.&quot;];
  &quot;TerminateOnTimeOut&quot; [URL=&quot;#candle.TerminateOnTimeOut&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;,tooltip=&quot;This class implements timeout on model training.&quot;];
  &quot;Callback&quot; -&gt; &quot;TerminateOnTimeOut&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.TerminateOnTimeOut.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#TerminateOnTimeOut.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.TerminateOnTimeOut.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>On every epoch end, check whether it exceeded timeout and terminate
training if necessary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="candle.TerminateOnTimeOut.on_train_begin">
<span class="sig-name descname"><span class="pre">on_train_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/keras_utils.html#TerminateOnTimeOut.on_train_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.TerminateOnTimeOut.on_train_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Start clock to calculate timeout.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.AbstentionAdapt_Callback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">AbstentionAdapt_Callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">acc_monitor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_monitor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_abs_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_scale_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_abs_acc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_abs_frac</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acc_gain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abs_gain</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#AbstentionAdapt_Callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.AbstentionAdapt_Callback" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback is used to adapt the parameter alpha in the abstention
loss.</p>
<p>The parameter alpha (weight of the abstention term in the abstention
loss) is increased or decreased adaptively during the training run.
It is decreased if the current abstention accuracy is less than the
minimum accuracy set or increased if the current abstention fraction
is greater than the maximum fraction set. The abstention accuracy
metric to use must be specified as the ‘acc_monitor’ argument in the
initialization of the callback. It could be: the global abstention
accuracy (abstention_acc), the abstention accuracy over the ith
class (acc_class_i), etc. The abstention metric to use must be
specified as the ‘abs_monitor’ argument in the initialization of the
callback. It should be the metric that computes the fraction of
samples for which the model is abstaining (abstention). The factor
alpha is modified if the current abstention accuracy is less than
the minimum accuracy set or if the current abstention fraction is
greater than the maximum fraction set. Thresholds for minimum and
maximum correction factors are computed and the correction over
alpha is not allowed to be less or greater than them, respectively,
to avoid huge swings in the abstention loss evolution.</p>
<p class="rubric">Inheritance</p>
digraph inheritancea330576ef3 {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;AbstentionAdapt_Callback&quot; [URL=&quot;#candle.AbstentionAdapt_Callback&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;,tooltip=&quot;This callback is used to adapt the parameter alpha in the abstention&quot;];
  &quot;Callback&quot; -&gt; &quot;AbstentionAdapt_Callback&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
  &quot;Callback&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Abstract base class used to build new callbacks.&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.AbstentionAdapt_Callback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#AbstentionAdapt_Callback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.AbstentionAdapt_Callback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the weight of abstention term on epoch end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – Current epoch in training.</p></li>
<li><p><strong>logs</strong> – Metrics stored during current keras training.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="candle.Contamination_Callback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">candle.</span></span><span class="sig-name descname"><span class="pre">Contamination_Callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#Contamination_Callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Contamination_Callback" title="Permalink to this definition">¶</a></dt>
<dd><p>This callback is used to update the parameters of the contamination
model.</p>
<p>This functionality follows the EM algorithm: in the E-step latent
variables are updated and in the M-step global variables are
updated. The global variables correspond to ‘a’ (probability of
membership to normal class), ‘sigmaSQ’ (variance of normal class)
and ‘gammaSQ’ (scale of Cauchy class, modeling outliers). The latent
variables correspond to ‘T_k’ (the first column corresponds to the
probability of membership to the normal distribution, while the
second column corresponds to the probability of membership to the
Cauchy distribution i.e. outlier).</p>
<p class="rubric">Inheritance</p>
digraph inheritance17bbdbb80b {
bgcolor=transparent;
rankdir=LR;
size=&quot;8.0, 12.0&quot;;
  &quot;Callback&quot; [fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,tooltip=&quot;Abstract base class used to build new callbacks.&quot;];
  &quot;Contamination_Callback&quot; [URL=&quot;#candle.Contamination_Callback&quot;,fillcolor=white,fontname=&quot;Vera Sans, DejaVu Sans, Liberation Sans, Arial, Helvetica, sans&quot;,fontsize=10,height=0.25,shape=box,style=&quot;setlinewidth(0.5),filled&quot;,target=&quot;_top&quot;,tooltip=&quot;This callback is used to update the parameters of the contamination&quot;];
  &quot;Callback&quot; -&gt; &quot;Contamination_Callback&quot; [arrowsize=0.5,style=&quot;setlinewidth(0.5)&quot;];
}
<dl class="py method">
<dt class="sig sig-object py" id="candle.Contamination_Callback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/candle/uq_keras_utils.html#Contamination_Callback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#candle.Contamination_Callback.on_epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the parameters of the distributions in the contamination
model on epoch end. The parameters updated are: ‘a’ for the global
weight of the membership to the normal distribution, ‘sigmaSQ’ for the
variance of the normal distribution and ‘gammaSQ’ for the scale of the
Cauchy distribution of outliers. The latent variables are updated as
well: ‘T_k’ describing in the first column the probability of
membership to normal distribution and in the second column probability
of membership to the Cauchy distribution i.e. outlier. Stores evolution
of global parameters (a, sigmaSQ and gammaSQ).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<em>int</em>) – Current epoch in training.</p></li>
<li><p><strong>logs</strong> – keras logs. Metrics stored during current keras training.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../tutorials/examples/run-summit/README.html" class="btn btn-neutral float-left" title="Run Modes: Summit" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../shared_installation.html" class="btn btn-neutral float-right" title="CANDLE Shared Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 | https://www.anl.gov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>