<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Data preprocessing - feature selection examples &mdash; CANDLE  documentation</title><link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="DARTS Examples" href="../darts/README.html" />
    <link rel="prev" title="Pilot1 ADRP Benchmark" href="../ADRP/README.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> CANDLE
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../readme.html">What is CANDLE?</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../index.html#preparation">Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../index.html#running-workflows">Running workflows</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../index.html#examples">Examples</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../ADRP/README.html">Pilot1 ADRP Benchmark</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Data preprocessing - feature selection examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l4"><a class="reference internal" href="#general-data-preprocessing-functions">General Data Preprocessing Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-preprocessing-functions-specific-to-pilot-1-applications">Data Preprocessing Functions Specific to Pilot 1 Applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#general-feature-selection-functions">General Feature Selection Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#feature-gene-selection-functions-specific-to-pilot-1-applications">Feature (Gene) Selection Functions Specific to Pilot 1 Applications</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-the-example">Running the example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../darts/README.html">DARTS Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mnist/README.html">MNIST Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../unet/README.html">U-NET Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../run-summit/README.html">Run Modes: Summit</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../shared_installation.html">CANDLE Shared Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribute.html">How to Contribute</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">CANDLE</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Tutorials</a> &raquo;</li>
      <li>Data preprocessing - feature selection examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/tutorials/examples/M16/README.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="data-preprocessing-feature-selection-examples">
<h1>Data preprocessing - feature selection examples<a class="headerlink" href="#data-preprocessing-feature-selection-examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h2>
<p>Data preprocessing is an important front-end step in data analysis that
prepares data for subsequent analysis. It not only enables the
subsequent analysis by processing and transforming data, but also
influences the quality of subsequent analysis sometimes significantly.
Several common examples of data preprocessing are data standardization
and normalization to remove/suppress noise, removal of batch effect to
combine datasets for larger studies, and generation of new
representations of data to enable new analyses. Feature selection can be
viewed as a kind of data preprocessing for prediction analysis. Its goal
is to select a (minimum) subset of available features, based on which
prediction models with a good performance can be constructed. And the
performance can be evaluated from multiple aspects, such as the
prediction accuracy and the speed of constructing the prediction model.</p>
<p>The data preprocessing methods can generate data partitions to enable
flexible cross-validation analysis, normalize and remove batch effects
from gene expression data of cancer cells, and generate genomic
representations at the gene set level for cancer cells. The feature
selection methods can filter features based on missing values and
variations, and perform feature decorrelation. Features without much
variation might not be useful for prediction and highly-correlated
features are not necessary to be all included in the prediction model.
We also implement and extend the co-expression extrapolation (COXEN)
gene selection method for Pilot 1 project [3], which can select
predictive and generalizable genes for predicting drug response in the
precision oncology applications.</p>
</div>
<div class="section" id="general-data-preprocessing-functions">
<h2>General Data Preprocessing Functions<a class="headerlink" href="#general-data-preprocessing-functions" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">generate_cross_validation_partition</span></code></p>
<p>To flexibly generate data partitions for cross-validation analysis, such
as partitioning of grouped samples into sets that do not share groups.</p>
</div>
<div class="section" id="data-preprocessing-functions-specific-to-pilot-1-applications">
<h2>Data Preprocessing Functions Specific to Pilot 1 Applications<a class="headerlink" href="#data-preprocessing-functions-specific-to-pilot-1-applications" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">quantile_normalizationa</span></code></p>
<p>To perform quantile normalization of genomic data [1] with tolerance of
missing values. <a class="reference external" href="#quantile-normalization-of-gene-expression-data">[see example
code]</a></p>
<p><code class="docutils literal notranslate"><span class="pre">combat_batch_effect_removal</span></code></p>
<p>To perform ComBat analysis [2] on gene expression data to remove batch
effects. <a class="reference external" href="#combat-batch-normalization-on-gene-expression-data">[see example
code]</a></p>
<p><code class="docutils literal notranslate"><span class="pre">generate_gene_set_data</span></code></p>
<p>To calculate genomic representations at gene set level, such as the
average expression values of genes in a pathway and the total number of
SNP mutations in a genetic pathway. <a class="reference external" href="#generate-gene-set-level-data">[see example
code]</a></p>
</div>
<div class="section" id="general-feature-selection-functions">
<h2>General Feature Selection Functions<a class="headerlink" href="#general-feature-selection-functions" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">select_features_by_missing_values</span></code></p>
<p>To remove features with (many) missing values. <a class="reference external" href="#select-features-based-on-missing-values">[see example
code]</a></p>
<p><code class="docutils literal notranslate"><span class="pre">select_features_by_variation</span></code></p>
<p>To remove features with no or small variations. <a class="reference external" href="#select-features-based-on-variation">[see example
code]</a></p>
<p><code class="docutils literal notranslate"><span class="pre">select_decorrelated_features</span></code></p>
<p>To select a subset of features that are not identical or highly
correlated with each other. <a class="reference external" href="#select-decorrelated-features">[see example
code]</a></p>
</div>
<div class="section" id="feature-gene-selection-functions-specific-to-pilot-1-applications">
<h2>Feature (Gene) Selection Functions Specific to Pilot 1 Applications<a class="headerlink" href="#feature-gene-selection-functions-specific-to-pilot-1-applications" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">coxen_single_drug_gene_selection</span></code></p>
<p>To perform co-expression extrapolation (COXEN) analysis [3] that selects
predictive and generalizable genes for predicting the response of tumor
cells to a specific drug.</p>
<p><code class="docutils literal notranslate"><span class="pre">coxen_multi_drug_gene_selection</span></code></p>
<p>To extend the COXEN approach for selecting genes to predict the response
of tumor cells to multiple drugs in precision oncology applications.</p>
</div>
<div class="section" id="running-the-example">
<h2>Running the example<a class="headerlink" href="#running-the-example" title="Permalink to this headline">¶</a></h2>
<p>The code demonstrates feature selection methods that CANDLE provides.</p>
<p>It can be run by executing <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">M16_test.py</span></code></p>
<div class="section" id="download-data">
<h3>Download data<a class="headerlink" href="#download-data" title="Permalink to this headline">¶</a></h3>
<p>Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># download all the data if needed from the repo</span>
<span class="n">data_url</span> <span class="o">=</span> <span class="s1">&#39;http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/Pilot1/uno/Candle_Milestone_16_Version_12_15_2019/Data/Data_For_Testing/&#39;</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;small_drug_descriptor_data_unique_samples.txt&#39;</span>
<span class="n">drug_descriptor</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">data_url</span><span class="o">+</span><span class="n">file_name</span><span class="p">,</span> <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;examples&#39;</span><span class="p">)</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;small_drug_response_data.txt&#39;</span>
<span class="n">response_data</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">data_url</span><span class="o">+</span><span class="n">file_name</span><span class="p">,</span> <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;examples&#39;</span><span class="p">)</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;Gene_Expression_Full_Data_Unique_Samples.txt&#39;</span>
<span class="n">gene_expression</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">data_url</span><span class="o">+</span><span class="n">file_name</span><span class="p">,</span> <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;examples&#39;</span><span class="p">)</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;CCLE_NCI60_Gene_Expression_Full_Data.txt&#39;</span>
<span class="n">ccle_nci60</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">data_url</span><span class="o">+</span><span class="n">file_name</span><span class="p">,</span> <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;examples&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Importing candle utils <span class="k">for</span> keras
<span class="nv">Origin</span> <span class="o">=</span>  http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/Pilot1/uno/Candle_Milestone_16_Version_12_15_2019/Data/Data_For_Testing/small_drug_descriptor_data_unique_samples.txt
<span class="nv">Origin</span> <span class="o">=</span>  http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/Pilot1/uno/Candle_Milestone_16_Version_12_15_2019/Data/Data_For_Testing/small_drug_response_data.txt
<span class="nv">Origin</span> <span class="o">=</span>  http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/Pilot1/uno/Candle_Milestone_16_Version_12_15_2019/Data/Data_For_Testing/Gene_Expression_Full_Data_Unique_Samples.txt
<span class="nv">Origin</span> <span class="o">=</span>  http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/Pilot1/uno/Candle_Milestone_16_Version_12_15_2019/Data/Data_For_Testing/CCLE_NCI60_Gene_Expression_Full_Data.txt
</pre></div>
</div>
</div>
<div class="section" id="download-gene-set">
<h3>Download gene set<a class="headerlink" href="#download-gene-set" title="Permalink to this headline">¶</a></h3>
<p>Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># download all the gene_set files needed</span>
<span class="n">data_url</span> <span class="o">=</span> <span class="s1">&#39;http://ftp.mcs.anl.gov/pub/candle/public/benchmarks/Pilot1/uno/Candle_Milestone_16_Version_12_15_2019/Data/Gene_Sets/MSigDB.v7.0/&#39;</span>
<span class="k">for</span> <span class="n">gene_set_category</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;c2.cgp&#39;</span><span class="p">,</span><span class="s1">&#39;c2.cp.biocarta&#39;</span><span class="p">,</span><span class="s1">&#39;c2.cp.kegg&#39;</span><span class="p">,</span><span class="s1">&#39;c2.cp.pid&#39;</span><span class="p">,</span><span class="s1">&#39;c2.cp.reactome&#39;</span><span class="p">,</span><span class="s1">&#39;c5.bp&#39;</span><span class="p">,</span><span class="s1">&#39;c5.cc&#39;</span><span class="p">,</span><span class="s1">&#39;c5.mf&#39;</span><span class="p">,</span><span class="s1">&#39;c6.all&#39;</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">gene_name_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;entrez&#39;</span><span class="p">,</span> <span class="s1">&#39;symbols&#39;</span><span class="p">]:</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="n">gene_set_category</span><span class="o">+</span><span class="s1">&#39;.v7.0.&#39;</span><span class="o">+</span><span class="n">gene_name_type</span><span class="o">+</span><span class="s1">&#39;.gmt&#39;</span>
        <span class="n">local_file</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">get_file</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">data_url</span><span class="o">+</span><span class="n">file_name</span><span class="p">,</span> <span class="n">cache_subdir</span><span class="o">=</span><span class="s1">&#39;examples/Gene_Sets/MSigDB.v7.0&#39;</span><span class="p">)</span>
<span class="c1"># extract base directory for gene_set data files</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">local_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">file_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gene Set data is locally stored at &#39;</span><span class="p">,</span> <span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cgp</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cgp</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">biocarta</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">biocarta</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">kegg</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">kegg</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">pid</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">pid</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">reactome</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c2</span><span class="o">.</span><span class="n">cp</span><span class="o">.</span><span class="n">reactome</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c5</span><span class="o">.</span><span class="n">bp</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c5</span><span class="o">.</span><span class="n">bp</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c5</span><span class="o">.</span><span class="n">cc</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c5</span><span class="o">.</span><span class="n">cc</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c5</span><span class="o">.</span><span class="n">mf</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c5</span><span class="o">.</span><span class="n">mf</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c6</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">entrez</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Origin</span> <span class="o">=</span>  <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">ftp</span><span class="o">.</span><span class="n">mcs</span><span class="o">.</span><span class="n">anl</span><span class="o">.</span><span class="n">gov</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">candle</span><span class="o">/</span><span class="n">public</span><span class="o">/</span><span class="n">benchmarks</span><span class="o">/</span><span class="n">Pilot1</span><span class="o">/</span><span class="n">uno</span><span class="o">/</span><span class="n">Candle_Milestone_16_Version_12_15_2019</span><span class="o">/</span><span class="n">Data</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">c6</span><span class="o">.</span><span class="n">all</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mf">0.</span><span class="n">symbols</span><span class="o">.</span><span class="n">gmt</span>
<span class="n">Gene</span> <span class="n">Set</span> <span class="n">data</span> <span class="ow">is</span> <span class="n">locally</span> <span class="n">stored</span> <span class="n">at</span>  <span class="o">/</span><span class="n">Users</span><span class="o">/</span><span class="n">hsyoo</span><span class="o">/</span><span class="n">projects</span><span class="o">/</span><span class="n">CANDLE</span><span class="o">/</span><span class="n">Benchmarks</span><span class="o">/</span><span class="n">common</span><span class="o">/../</span><span class="n">Data</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">Gene_Sets</span><span class="o">/</span><span class="n">MSigDB</span><span class="o">.</span><span class="n">v7</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span>
</pre></div>
</div>
</div>
<div class="section" id="select-features-based-on-missing-values">
<h3>Select features based on missing values<a class="headerlink" href="#select-features-based-on-missing-values" title="Permalink to this headline">¶</a></h3>
<p>Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing select_features_by_missing_values&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Drug descriptor dataframe includes 10 drugs (rows) and 10 drug descriptor features (columns)&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">drug_descriptor</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;na&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Select features with missing rates smaller than 0.1&#39;</span><span class="p">)</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">select_features_by_missing_values</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Feature IDs&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Select features with missing rates smaller than 0.3&#39;</span><span class="p">)</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">select_features_by_missing_values</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Feature IDs&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Testing select_features_by_missing_values
Drug descriptor dataframe includes <span class="m">10</span> drugs <span class="o">(</span>rows<span class="o">)</span> and <span class="m">10</span> drug descriptor features <span class="o">(</span>columns<span class="o">)</span>
               MW     AMW      Sv      Se  ...     Mv  Psi_e_1d  Psi_e_1s  VE3sign_X
Drug_1     <span class="m">475</span>.40   <span class="m">8</span>.804  <span class="m">34</span>.718  <span class="m">54</span>.523  ...  <span class="m">0</span>.643       NaN       NaN        NaN
Drug_10    <span class="m">457</span>.71  <span class="m">10</span>.898  <span class="m">29</span>.154  <span class="m">43</span>.640  ...  <span class="m">0</span>.694       NaN       NaN     -2.752
Drug_100   <span class="m">561</span>.80   <span class="m">6</span>.688  <span class="m">49</span>.975  <span class="m">83</span>.607  ...  <span class="m">0</span>.595       NaN       NaN     -4.335
Drug_1000  <span class="m">362</span>.51   <span class="m">6</span>.840  <span class="m">32</span>.794  <span class="m">52</span>.461  ...  <span class="m">0</span>.619       NaN       NaN     -9.968
Drug_1001  <span class="m">628</span>.83   <span class="m">7</span>.763  <span class="m">51</span>.593  <span class="m">81</span>.570  ...  <span class="m">0</span>.637       NaN       NaN     -2.166
Drug_1002  <span class="m">377</span>.19  <span class="m">10</span>.777  <span class="m">26</span>.191  <span class="m">36</span>.578  ...  <span class="m">0</span>.748       NaN       NaN     -1.526
Drug_1003  <span class="m">371</span>.42   <span class="m">8</span>.254  <span class="m">30</span>.896  <span class="m">45</span>.473  ...  <span class="m">0</span>.687       NaN       NaN     -4.983
Drug_1004  <span class="m">453</span>.60   <span class="m">8</span>.100  <span class="m">37</span>.949  <span class="m">55</span>.872  ...  <span class="m">0</span>.678       NaN       NaN     -4.100
Drug_1005  <span class="m">277</span>.35   <span class="m">7</span>.704  <span class="m">23</span>.940  <span class="m">35</span>.934  ...  <span class="m">0</span>.665       NaN       NaN     -5.234
Drug_1006  <span class="m">409</span>.47   <span class="m">8</span>.189  <span class="m">34</span>.423  <span class="m">50</span>.356  ...  <span class="m">0</span>.688       NaN       NaN     -2.513

<span class="o">[</span><span class="m">10</span> rows x <span class="m">10</span> columns<span class="o">]</span>
Select features with missing rates smaller than <span class="m">0</span>.1
Feature IDs <span class="o">[</span><span class="m">0</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span><span class="o">]</span>
Select features with missing rates smaller than <span class="m">0</span>.3
Feature IDs <span class="o">[</span><span class="m">0</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">9</span><span class="o">]</span>
</pre></div>
</div>
</div>
<div class="section" id="select-features-based-on-variation">
<h3>Select features based on variation<a class="headerlink" href="#select-features-based-on-variation" title="Permalink to this headline">¶</a></h3>
<p>Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing select_features_by_variation&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Select features with a variance larger than 100&#39;</span><span class="p">)</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">select_features_by_variation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">variation_measure</span><span class="o">=</span><span class="s1">&#39;var&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">portion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">draw_histogram</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Feature IDs&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Select the top 2 features with the largest standard deviation&#39;</span><span class="p">)</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">select_features_by_variation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">variation_measure</span><span class="o">=</span><span class="s1">&#39;std&#39;</span><span class="p">,</span> <span class="n">portion</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Feature IDs&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="n">select_features_by_variation</span>
<span class="n">Select</span> <span class="n">features</span> <span class="k">with</span> <span class="n">a</span> <span class="n">variance</span> <span class="n">larger</span> <span class="n">than</span> <span class="mi">100</span>
<span class="n">Feature</span> <span class="n">IDs</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">3</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">Select</span> <span class="n">the</span> <span class="n">top</span> <span class="mi">2</span> <span class="n">features</span> <span class="k">with</span> <span class="n">the</span> <span class="n">largest</span> <span class="n">standard</span> <span class="n">deviation</span>
<span class="n">Feature</span> <span class="n">IDs</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="select-decorrelated-features">
<h3>Select decorrelated features<a class="headerlink" href="#select-decorrelated-features" title="Permalink to this headline">¶</a></h3>
<p>Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing select_decorrelated_features&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Select features that are not identical to each other and are not all missing.&#39;</span><span class="p">)</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">select_decorrelated_features</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Feature IDs&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Select features whose absolute mutual Spearman correlation coefficient is smaller than 0.8&#39;</span><span class="p">)</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">select_decorrelated_features</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Feature IDs&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="n">select_decorrelated_features</span>
<span class="n">Select</span> <span class="n">features</span> <span class="n">that</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">identical</span> <span class="n">to</span> <span class="n">each</span> <span class="n">other</span> <span class="ow">and</span> <span class="n">are</span> <span class="ow">not</span> <span class="nb">all</span> <span class="n">missing</span><span class="o">.</span>
<span class="n">Feature</span> <span class="n">IDs</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">Select</span> <span class="n">features</span> <span class="n">whose</span> <span class="n">absolute</span> <span class="n">mutual</span> <span class="n">Spearman</span> <span class="n">correlation</span> <span class="n">coefficient</span> <span class="ow">is</span> <span class="n">smaller</span> <span class="n">than</span> <span class="mf">0.8</span>
<span class="n">Feature</span> <span class="n">IDs</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">6</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-cross-validation-partitions-of-data">
<h3>Generate cross-validation partitions of data<a class="headerlink" href="#generate-cross-validation-partitions-of-data" title="Permalink to this headline">¶</a></h3>
<p>Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing generate_cross_validation_partition&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Generate 5-fold cross-validation partition of 10 samples twice&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">generate_cross_validation_partition</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">portions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">random_seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Drug response data of 5 cell lines treated by various drugs.&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">response_data</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;na&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Generate partition indices to divide the data into 4 sets without shared cell lines for 5 times.&#39;</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">generate_cross_validation_partition</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">CELL</span><span class="p">,</span> <span class="n">n_folds</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n_repeats</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">portions</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">random_seed</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="n">generate_cross_validation_partition</span>
<span class="n">Generate</span> <span class="mi">5</span><span class="o">-</span><span class="n">fold</span> <span class="n">cross</span><span class="o">-</span><span class="n">validation</span> <span class="n">partition</span> <span class="n">of</span> <span class="mi">10</span> <span class="n">samples</span> <span class="n">twice</span>
<span class="p">[[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]]]</span>
<span class="n">Drug</span> <span class="n">response</span> <span class="n">data</span> <span class="n">of</span> <span class="mi">5</span> <span class="n">cell</span> <span class="n">lines</span> <span class="n">treated</span> <span class="n">by</span> <span class="n">various</span> <span class="n">drugs</span><span class="o">.</span>
   <span class="n">SOURCE</span>        <span class="n">CELL</span>     <span class="n">DRUG</span>     <span class="n">AUC</span>   <span class="n">EC50</span>   <span class="n">EC50se</span>   <span class="n">R2fit</span>      <span class="n">HS</span>
<span class="mi">0</span>    <span class="n">CCLE</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">22</span><span class="n">RV1</span>   <span class="n">CCLE</span><span class="o">.</span><span class="mi">1</span>  <span class="mf">0.7153</span>  <span class="mf">5.660</span>   <span class="mf">0.6867</span>  <span class="mf">0.9533</span>  <span class="mf">0.6669</span>
<span class="mi">1</span>    <span class="n">CCLE</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">22</span><span class="n">RV1</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">10</span>  <span class="mf">0.9579</span>  <span class="mf">7.023</span>   <span class="mf">0.7111</span>  <span class="mf">0.4332</span>  <span class="mf">4.0000</span>
<span class="mi">2</span>    <span class="n">CCLE</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">22</span><span class="n">RV1</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">11</span>  <span class="mf">0.4130</span>  <span class="mf">7.551</span>   <span class="mf">0.0385</span>  <span class="mf">0.9948</span>  <span class="mf">1.3380</span>
<span class="mi">3</span>    <span class="n">CCLE</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">22</span><span class="n">RV1</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">12</span>  <span class="mf">0.8004</span>  <span class="mf">5.198</span>  <span class="mf">11.7100</span>  <span class="mf">0.9944</span>  <span class="mf">4.0000</span>
<span class="mi">4</span>    <span class="n">CCLE</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">22</span><span class="n">RV1</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">13</span>  <span class="mf">0.5071</span>  <span class="mf">7.149</span>   <span class="mf">0.3175</span>  <span class="mf">0.8069</span>  <span class="mf">1.0150</span>
<span class="o">..</span>    <span class="o">...</span>         <span class="o">...</span>      <span class="o">...</span>     <span class="o">...</span>    <span class="o">...</span>      <span class="o">...</span>     <span class="o">...</span>     <span class="o">...</span>
<span class="mi">95</span>   <span class="n">CCLE</span>    <span class="n">CCLE</span><span class="o">.</span><span class="mi">697</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">12</span>  <span class="mf">0.7869</span>  <span class="mf">5.278</span>  <span class="mf">20.1200</span>  <span class="mf">0.8856</span>  <span class="mf">4.0000</span>
<span class="mi">96</span>   <span class="n">CCLE</span>    <span class="n">CCLE</span><span class="o">.</span><span class="mi">697</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">13</span>  <span class="mf">0.4433</span>  <span class="mf">7.474</span>   <span class="mf">0.0265</span>  <span class="mf">0.9978</span>  <span class="mf">3.7080</span>
<span class="mi">97</span>   <span class="n">CCLE</span>    <span class="n">CCLE</span><span class="o">.</span><span class="mi">697</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">14</span>  <span class="mf">0.4337</span>  <span class="mf">7.466</span>   <span class="mf">0.0106</span>  <span class="mf">0.9996</span>  <span class="mf">3.4330</span>
<span class="mi">98</span>   <span class="n">CCLE</span>    <span class="n">CCLE</span><span class="o">.</span><span class="mi">697</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">15</span>  <span class="mf">0.8721</span>  <span class="mf">3.097</span>  <span class="mf">29.1300</span>  <span class="mf">0.4884</span>  <span class="mf">0.2528</span>
<span class="mi">99</span>   <span class="n">CCLE</span>    <span class="n">CCLE</span><span class="o">.</span><span class="mi">697</span>  <span class="n">CCLE</span><span class="o">.</span><span class="mi">16</span>  <span class="mf">0.7955</span>  <span class="mf">7.496</span>   <span class="mf">0.1195</span>  <span class="mf">0.9396</span>  <span class="mf">1.9560</span>

<span class="p">[</span><span class="mi">100</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">8</span> <span class="n">columns</span><span class="p">]</span>
<span class="n">Generate</span> <span class="n">partition</span> <span class="n">indices</span> <span class="n">to</span> <span class="n">divide</span> <span class="n">the</span> <span class="n">data</span> <span class="n">into</span> <span class="mi">4</span> <span class="n">sets</span> <span class="n">without</span> <span class="n">shared</span> <span class="n">cell</span> <span class="n">lines</span> <span class="k">for</span> <span class="mi">5</span> <span class="n">times</span><span class="o">.</span>
<span class="p">[[[</span><span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">],</span> <span class="p">[</span><span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span> <span class="p">[</span><span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span> <span class="p">[</span><span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span> <span class="p">[</span><span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">],</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span> <span class="p">[</span><span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">],</span> <span class="p">[</span><span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">],</span> <span class="p">[</span><span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">],</span> <span class="p">[</span><span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">99</span><span class="p">]]]</span>
<span class="n">Using</span> <span class="n">TensorFlow</span> <span class="n">backend</span><span class="o">.</span>
<span class="o">...</span>
<span class="n">found</span> <span class="mi">2</span> <span class="n">batches</span>
<span class="n">found</span> <span class="mi">0</span> <span class="n">numerical</span> <span class="n">covariates</span><span class="o">...</span>
<span class="n">found</span> <span class="mi">0</span> <span class="n">categorical</span> <span class="n">variables</span><span class="p">:</span>
<span class="n">Standardizing</span> <span class="n">Data</span> <span class="n">across</span> <span class="n">genes</span><span class="o">.</span>
<span class="n">Fitting</span> <span class="n">L</span><span class="o">/</span><span class="n">S</span> <span class="n">model</span> <span class="ow">and</span> <span class="n">finding</span> <span class="n">priors</span>
<span class="n">Finding</span> <span class="n">parametric</span> <span class="n">adjustments</span>
</pre></div>
</div>
</div>
<div class="section" id="quantile-normalization-of-gene-expression-data">
<h3>Quantile normalization of gene expression data<a class="headerlink" href="#quantile-normalization-of-gene-expression-data" title="Permalink to this headline">¶</a></h3>
<p>Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing quantile_normalization&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gene expression data of 897 cell lines (columns) and 17741 genes (rows).&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">gene_expression</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;na&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Before normalization&#39;</span><span class="p">)</span>
<span class="n">third_quartile</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max difference of third quartile between cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">third_quartile</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">third_quartile</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">second_quartile</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max difference of median between cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">second_quartile</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">second_quartile</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">first_quartile</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max difference of first quartile between cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">first_quartile</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">first_quartile</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">norm_data</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">quantile_normalization</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="n">norm_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After normalization&#39;</span><span class="p">)</span>
<span class="n">third_quartile</span> <span class="o">=</span> <span class="n">norm_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max difference of third quartile between cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">third_quartile</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">third_quartile</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">second_quartile</span> <span class="o">=</span> <span class="n">norm_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max difference of median between cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">second_quartile</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">second_quartile</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">first_quartile</span> <span class="o">=</span> <span class="n">norm_data</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Max difference of first quartile between cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">first_quartile</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">first_quartile</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="n">quantile_normalization</span>
<span class="n">Gene</span> <span class="n">expression</span> <span class="n">data</span> <span class="n">of</span> <span class="mi">897</span> <span class="n">cell</span> <span class="n">lines</span> <span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">17741</span> <span class="n">genes</span> <span class="p">(</span><span class="n">rows</span><span class="p">)</span><span class="o">.</span>
                     <span class="n">CCL_61</span>  <span class="n">CCL_62</span>  <span class="n">CCL_63</span>  <span class="o">...</span>  <span class="n">CCL_1076</span>  <span class="n">CCL_1077</span>  <span class="n">CCL_1078</span>
<span class="n">entrezID</span> <span class="n">geneSymbol</span>                          <span class="o">...</span>
<span class="mi">1</span>        <span class="n">A1BG</span>          <span class="mf">0.99</span>    <span class="mf">0.03</span>    <span class="mf">0.36</span>  <span class="o">...</span>      <span class="mf">2.56</span>      <span class="mf">3.55</span>      <span class="mf">3.04</span>
<span class="mi">29974</span>    <span class="n">A1CF</span>          <span class="mf">4.03</span>    <span class="mf">3.03</span>    <span class="mf">0.00</span>  <span class="o">...</span>      <span class="mf">0.00</span>      <span class="mf">0.03</span>      <span class="mf">0.00</span>
<span class="mi">2</span>        <span class="n">A2M</span>           <span class="mf">2.68</span>    <span class="mf">0.03</span>    <span class="mf">0.16</span>  <span class="o">...</span>      <span class="mf">0.77</span>      <span class="mf">0.31</span>      <span class="mf">1.20</span>
<span class="mi">144568</span>   <span class="n">A2ML1</span>         <span class="mf">0.07</span>    <span class="mf">0.07</span>    <span class="mf">0.01</span>  <span class="o">...</span>      <span class="mf">0.01</span>      <span class="mf">0.00</span>      <span class="mf">1.09</span>
<span class="mi">127550</span>   <span class="n">A3GALT2</span>       <span class="mf">0.15</span>    <span class="mf">0.00</span>    <span class="mf">0.06</span>  <span class="o">...</span>      <span class="mf">2.34</span>      <span class="mf">0.00</span>      <span class="mf">0.03</span>
<span class="o">...</span>                     <span class="o">...</span>     <span class="o">...</span>     <span class="o">...</span>  <span class="o">...</span>       <span class="o">...</span>       <span class="o">...</span>       <span class="o">...</span>
<span class="mi">440590</span>   <span class="n">ZYG11A</span>        <span class="mf">0.41</span>    <span class="mf">0.06</span>    <span class="mf">1.70</span>  <span class="o">...</span>      <span class="mf">0.75</span>      <span class="mf">3.44</span>      <span class="mf">2.44</span>
<span class="mi">79699</span>    <span class="n">ZYG11B</span>        <span class="mf">4.45</span>    <span class="mf">4.23</span>    <span class="mf">3.08</span>  <span class="o">...</span>      <span class="mf">4.25</span>      <span class="mf">3.61</span>      <span class="mf">3.68</span>
<span class="mi">7791</span>     <span class="n">ZYX</span>           <span class="mf">4.65</span>    <span class="mf">5.72</span>    <span class="mf">6.67</span>  <span class="o">...</span>      <span class="mf">7.78</span>      <span class="mf">4.12</span>      <span class="mf">5.97</span>
<span class="mi">23140</span>    <span class="n">ZZEF1</span>         <span class="mf">4.14</span>    <span class="mf">3.98</span>    <span class="mf">3.90</span>  <span class="o">...</span>      <span class="mf">4.62</span>      <span class="mf">3.76</span>      <span class="mf">3.54</span>
<span class="mi">26009</span>    <span class="n">ZZZ3</span>          <span class="mf">4.77</span>    <span class="mf">5.01</span>    <span class="mf">3.90</span>  <span class="o">...</span>      <span class="mf">4.38</span>      <span class="mf">3.46</span>      <span class="mf">3.60</span>

<span class="p">[</span><span class="mi">17741</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">897</span> <span class="n">columns</span><span class="p">]</span>
<span class="n">Before</span> <span class="n">normalization</span>
<span class="n">Max</span> <span class="n">difference</span> <span class="n">of</span> <span class="n">third</span> <span class="n">quartile</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">1.86</span>
<span class="n">Max</span> <span class="n">difference</span> <span class="n">of</span> <span class="n">median</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">2.25</span>
<span class="n">Max</span> <span class="n">difference</span> <span class="n">of</span> <span class="n">first</span> <span class="n">quartile</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">0.5</span>
<span class="n">After</span> <span class="n">normalization</span>
<span class="n">Max</span> <span class="n">difference</span> <span class="n">of</span> <span class="n">third</span> <span class="n">quartile</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">0.01</span>
<span class="n">Max</span> <span class="n">difference</span> <span class="n">of</span> <span class="n">median</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">0.02</span>
<span class="n">Max</span> <span class="n">difference</span> <span class="n">of</span> <span class="n">first</span> <span class="n">quartile</span> <span class="n">between</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">0.06</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-gene-set-level-data">
<h3>Generate gene-set-level data<a class="headerlink" href="#generate-gene-set-level-data" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing generate_gene_set_data&#39;</span><span class="p">)</span>
<span class="n">gene_set_data</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">generate_gene_set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">norm_data</span><span class="p">),</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">norm_data</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">gene_name_type</span><span class="o">=</span><span class="s1">&#39;entrez&#39;</span><span class="p">,</span>
                                       <span class="n">gene_set_category</span><span class="o">=</span><span class="s1">&#39;c6.all&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Generate gene-set-level data of 897 cell lines and 189 oncogenic signature gene sets&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_set_data</span><span class="p">)</span>
<span class="n">gene_set_data</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">generate_gene_set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">norm_data</span><span class="p">),</span> <span class="p">[</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">norm_data</span><span class="o">.</span><span class="n">index</span><span class="p">],</span> <span class="n">gene_name_type</span><span class="o">=</span><span class="s1">&#39;symbols&#39;</span><span class="p">,</span>
                                       <span class="n">gene_set_category</span><span class="o">=</span><span class="s1">&#39;c2.cp.kegg&#39;</span><span class="p">,</span> <span class="n">metric</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">,</span> <span class="n">standardize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data_dir</span><span class="o">=</span><span class="n">data_dir</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Generate gene-set-level data of 897 cell lines and 186 KEGG pathways&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">gene_set_data</span><span class="p">)</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="n">generate_gene_set_data</span>
<span class="n">Generate</span> <span class="n">gene</span><span class="o">-</span><span class="nb">set</span><span class="o">-</span><span class="n">level</span> <span class="n">data</span> <span class="n">of</span> <span class="mi">897</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">and</span> <span class="mi">189</span> <span class="n">oncogenic</span> <span class="n">signature</span> <span class="n">gene</span> <span class="n">sets</span>
          <span class="n">GLI1_UP</span><span class="o">.</span><span class="n">V1_DN</span>  <span class="n">GLI1_UP</span><span class="o">.</span><span class="n">V1_UP</span>  <span class="o">...</span>  <span class="n">LEF1_UP</span><span class="o">.</span><span class="n">V1_DN</span>  <span class="n">LEF1_UP</span><span class="o">.</span><span class="n">V1_UP</span>
<span class="n">CCL_61</span>        <span class="o">-</span><span class="mf">0.031096</span>       <span class="mf">0.283946</span>  <span class="o">...</span>       <span class="mf">0.096461</span>      <span class="o">-</span><span class="mf">0.329343</span>
<span class="n">CCL_62</span>         <span class="mf">0.362855</span>      <span class="o">-</span><span class="mf">0.101684</span>  <span class="o">...</span>       <span class="mf">0.426951</span>      <span class="o">-</span><span class="mf">0.477634</span>
<span class="n">CCL_63</span>        <span class="o">-</span><span class="mf">0.304989</span>      <span class="o">-</span><span class="mf">0.165160</span>  <span class="o">...</span>       <span class="mf">0.036932</span>      <span class="o">-</span><span class="mf">0.201916</span>
<span class="n">CCL_64</span>        <span class="o">-</span><span class="mf">0.037737</span>      <span class="o">-</span><span class="mf">0.043124</span>  <span class="o">...</span>       <span class="mf">0.154256</span>      <span class="o">-</span><span class="mf">0.210188</span>
<span class="n">CCL_65</span>         <span class="mf">0.102477</span>       <span class="mf">0.438871</span>  <span class="o">...</span>      <span class="o">-</span><span class="mf">0.166487</span>       <span class="mf">0.287382</span>
<span class="o">...</span>                 <span class="o">...</span>            <span class="o">...</span>  <span class="o">...</span>            <span class="o">...</span>            <span class="o">...</span>
<span class="n">CCL_1074</span>       <span class="mf">0.508978</span>       <span class="mf">0.137934</span>  <span class="o">...</span>       <span class="mf">0.148213</span>       <span class="mf">0.166717</span>
<span class="n">CCL_1075</span>      <span class="o">-</span><span class="mf">0.145029</span>       <span class="mf">0.216169</span>  <span class="o">...</span>      <span class="o">-</span><span class="mf">0.067391</span>       <span class="mf">0.258455</span>
<span class="n">CCL_1076</span>      <span class="o">-</span><span class="mf">0.357758</span>       <span class="mf">0.337235</span>  <span class="o">...</span>       <span class="mf">0.008950</span>       <span class="mf">0.186134</span>
<span class="n">CCL_1077</span>       <span class="mf">0.086597</span>      <span class="o">-</span><span class="mf">0.266070</span>  <span class="o">...</span>       <span class="mf">0.217244</span>      <span class="o">-</span><span class="mf">0.276022</span>
<span class="n">CCL_1078</span>       <span class="mf">0.374237</span>      <span class="o">-</span><span class="mf">0.428383</span>  <span class="o">...</span>       <span class="mf">0.312984</span>      <span class="o">-</span><span class="mf">0.303721</span>

<span class="p">[</span><span class="mi">897</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">189</span> <span class="n">columns</span><span class="p">]</span>
<span class="n">Generate</span> <span class="n">gene</span><span class="o">-</span><span class="nb">set</span><span class="o">-</span><span class="n">level</span> <span class="n">data</span> <span class="n">of</span> <span class="mi">897</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">and</span> <span class="mi">186</span> <span class="n">KEGG</span> <span class="n">pathways</span>
          <span class="n">KEGG_GLYCOLYSIS_GLUCONEOGENESIS</span>  <span class="o">...</span>  <span class="n">KEGG_VIRAL_MYOCARDITIS</span>
<span class="n">CCL_61</span>                           <span class="mf">6.495365</span>  <span class="o">...</span>              <span class="o">-</span><span class="mf">30.504868</span>
<span class="n">CCL_62</span>                          <span class="mf">30.679006</span>  <span class="o">...</span>               <span class="o">-</span><span class="mf">7.205641</span>
<span class="n">CCL_63</span>                          <span class="mf">10.534238</span>  <span class="o">...</span>               <span class="o">-</span><span class="mf">5.414998</span>
<span class="n">CCL_64</span>                           <span class="mf">6.142140</span>  <span class="o">...</span>              <span class="o">-</span><span class="mf">10.555601</span>
<span class="n">CCL_65</span>                          <span class="o">-</span><span class="mf">0.303868</span>  <span class="o">...</span>               <span class="o">-</span><span class="mf">9.784998</span>
<span class="o">...</span>                                   <span class="o">...</span>  <span class="o">...</span>                     <span class="o">...</span>
<span class="n">CCL_1074</span>                        <span class="o">-</span><span class="mf">1.945281</span>  <span class="o">...</span>                <span class="mf">6.891960</span>
<span class="n">CCL_1075</span>                       <span class="o">-</span><span class="mf">21.373730</span>  <span class="o">...</span>                <span class="mf">0.612092</span>
<span class="n">CCL_1076</span>                       <span class="o">-</span><span class="mf">11.711818</span>  <span class="o">...</span>              <span class="o">-</span><span class="mf">10.353794</span>
<span class="n">CCL_1077</span>                       <span class="o">-</span><span class="mf">11.576702</span>  <span class="o">...</span>              <span class="o">-</span><span class="mf">31.679962</span>
<span class="n">CCL_1078</span>                       <span class="o">-</span><span class="mf">10.355489</span>  <span class="o">...</span>              <span class="o">-</span><span class="mf">26.232325</span>

<span class="p">[</span><span class="mi">897</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">186</span> <span class="n">columns</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="combat-batch-normalization-on-gene-expression-data">
<h3>Combat batch normalization on gene expression data<a class="headerlink" href="#combat-batch-normalization-on-gene-expression-data" title="Permalink to this headline">¶</a></h3>
<p>Code</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Testing combat_batch_effect_removal&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gene expression data of 60 NCI60 cell lines and 1018 CCLE cell lines with 17741 genes.&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">ccle_nci60</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">na_values</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;na&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">resource</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Before removal of batch effect between NCI60 and CCLE datasets&#39;</span><span class="p">)</span>
<span class="c1"># Identify NCI60 cell lines and quantile normalize their gene expression data</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">resource</span> <span class="o">==</span> <span class="s1">&#39;NCI60&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">norm_data_NCI60</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">quantile_normalization</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="nb">id</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average third quartile of NCI60 cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">norm_data_NCI60</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average median of NCI60 cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">norm_data_NCI60</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average first quartile of NCI60 cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">norm_data_NCI60</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># Identify CCLE cell lines and quantile normalize their gene expression data</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">resource</span> <span class="o">==</span> <span class="s1">&#39;CCLE&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">norm_data_CCLE</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">quantile_normalization</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="nb">id</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average third quartile of CCLE cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">norm_data_CCLE</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average median of CCLE cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">norm_data_CCLE</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average first quartile of CCLE cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">norm_data_CCLE</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># Combine normalized data of NCI60 cell lines and CCLE cell lines</span>
<span class="n">norm_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">norm_data_NCI60</span><span class="p">,</span> <span class="n">norm_data_CCLE</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">norm_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">norm_data</span><span class="p">)</span>

<span class="c1"># Apply ComBat algorithm to remove the batch effect between NCI60 and CCLE</span>
<span class="n">corrected_data</span> <span class="o">=</span> <span class="n">candle</span><span class="o">.</span><span class="n">combat_batch_effect_removal</span><span class="p">(</span><span class="n">norm_data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">norm_data</span><span class="o">.</span><span class="n">columns</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">norm_data</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;After removal of batch effect between NCI60 and CCLE datasets&#39;</span><span class="p">)</span>

<span class="n">resource</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">corrected_data</span><span class="o">.</span><span class="n">columns</span><span class="p">])</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">resource</span> <span class="o">==</span> <span class="s1">&#39;NCI60&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">corrected_data_NCI60</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">corrected_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="nb">id</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average third quartile of NCI60 cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">corrected_data_NCI60</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average median of NCI60 cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">corrected_data_NCI60</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average first quartile of NCI60 cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">corrected_data_NCI60</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>

<span class="c1"># Identify CCLE cell lines and quantile normalize their gene expression data</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">resource</span> <span class="o">==</span> <span class="s1">&#39;CCLE&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">corrected_data_CCLE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">corrected_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="nb">id</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average third quartile of CCLE cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">corrected_data_CCLE</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average median of CCLE cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">corrected_data_CCLE</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Average first quartile of CCLE cell lines is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">corrected_data_CCLE</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)))</span>
</pre></div>
</div>
<p>Output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Testing</span> <span class="n">combat_batch_effect_removal</span>
<span class="n">Gene</span> <span class="n">expression</span> <span class="n">data</span> <span class="n">of</span> <span class="mi">60</span> <span class="n">NCI60</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">and</span> <span class="mi">1018</span> <span class="n">CCLE</span> <span class="n">cell</span> <span class="n">lines</span> <span class="k">with</span> <span class="mi">17741</span> <span class="n">genes</span><span class="o">.</span>
                     <span class="n">NCI60</span><span class="o">.</span><span class="mi">786</span><span class="o">-</span><span class="mi">0</span><span class="o">|</span><span class="n">CCL_1</span>  <span class="o">...</span>  <span class="n">CCLE</span><span class="o">.</span><span class="n">ZR7530</span><span class="o">|</span><span class="n">CCL_1078</span>
<span class="n">entrezID</span> <span class="n">geneSymbol</span>                     <span class="o">...</span>
<span class="mi">1</span>        <span class="n">A1BG</span>                     <span class="mf">0.00</span>  <span class="o">...</span>                  <span class="mf">3.04</span>
<span class="mi">29974</span>    <span class="n">A1CF</span>                     <span class="mf">0.00</span>  <span class="o">...</span>                  <span class="mf">0.00</span>
<span class="mi">2</span>        <span class="n">A2M</span>                      <span class="mf">0.00</span>  <span class="o">...</span>                  <span class="mf">1.20</span>
<span class="mi">144568</span>   <span class="n">A2ML1</span>                    <span class="mf">0.00</span>  <span class="o">...</span>                  <span class="mf">1.09</span>
<span class="mi">127550</span>   <span class="n">A3GALT2</span>                  <span class="mf">0.00</span>  <span class="o">...</span>                  <span class="mf">0.03</span>
<span class="o">...</span>                                <span class="o">...</span>  <span class="o">...</span>                   <span class="o">...</span>
<span class="mi">440590</span>   <span class="n">ZYG11A</span>                   <span class="mf">0.01</span>  <span class="o">...</span>                  <span class="mf">2.44</span>
<span class="mi">79699</span>    <span class="n">ZYG11B</span>                   <span class="mf">3.37</span>  <span class="o">...</span>                  <span class="mf">3.68</span>
<span class="mi">7791</span>     <span class="n">ZYX</span>                      <span class="mf">7.05</span>  <span class="o">...</span>                  <span class="mf">5.97</span>
<span class="mi">23140</span>    <span class="n">ZZEF1</span>                    <span class="mf">4.05</span>  <span class="o">...</span>                  <span class="mf">3.54</span>
<span class="mi">26009</span>    <span class="n">ZZZ3</span>                     <span class="mf">4.10</span>  <span class="o">...</span>                  <span class="mf">3.60</span>

<span class="p">[</span><span class="mi">17741</span> <span class="n">rows</span> <span class="n">x</span> <span class="mi">1078</span> <span class="n">columns</span><span class="p">]</span>
<span class="n">Before</span> <span class="n">removal</span> <span class="n">of</span> <span class="n">batch</span> <span class="n">effect</span> <span class="n">between</span> <span class="n">NCI60</span> <span class="ow">and</span> <span class="n">CCLE</span> <span class="n">datasets</span>
<span class="n">Average</span> <span class="n">third</span> <span class="n">quartile</span> <span class="n">of</span> <span class="n">NCI60</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">4.0</span>
<span class="n">Average</span> <span class="n">median</span> <span class="n">of</span> <span class="n">NCI60</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">1.71</span>
<span class="n">Average</span> <span class="n">first</span> <span class="n">quartile</span> <span class="n">of</span> <span class="n">NCI60</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">0.01</span>
<span class="n">Average</span> <span class="n">third</span> <span class="n">quartile</span> <span class="n">of</span> <span class="n">CCLE</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">4.88</span>
<span class="n">Average</span> <span class="n">median</span> <span class="n">of</span> <span class="n">CCLE</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">2.75</span>
<span class="n">Average</span> <span class="n">first</span> <span class="n">quartile</span> <span class="n">of</span> <span class="n">CCLE</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">0.14</span>
<span class="n">Adjusting</span> <span class="n">data</span>
<span class="n">After</span> <span class="n">removal</span> <span class="n">of</span> <span class="n">batch</span> <span class="n">effect</span> <span class="n">between</span> <span class="n">NCI60</span> <span class="ow">and</span> <span class="n">CCLE</span> <span class="n">datasets</span>
<span class="n">Average</span> <span class="n">third</span> <span class="n">quartile</span> <span class="n">of</span> <span class="n">NCI60</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">4.81</span>
<span class="n">Average</span> <span class="n">median</span> <span class="n">of</span> <span class="n">NCI60</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">2.65</span>
<span class="n">Average</span> <span class="n">first</span> <span class="n">quartile</span> <span class="n">of</span> <span class="n">NCI60</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">0.23</span>
<span class="n">Average</span> <span class="n">third</span> <span class="n">quartile</span> <span class="n">of</span> <span class="n">CCLE</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">4.83</span>
<span class="n">Average</span> <span class="n">median</span> <span class="n">of</span> <span class="n">CCLE</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">2.72</span>
<span class="n">Average</span> <span class="n">first</span> <span class="n">quartile</span> <span class="n">of</span> <span class="n">CCLE</span> <span class="n">cell</span> <span class="n">lines</span> <span class="ow">is</span> <span class="mf">0.13</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li><p>Bolstad BM, Irizarry RA, Astrand M, et al. (2003) <em>A comparison of
normalization methods for high density oligonucleotide array data
based on variance and bias</em> Bioinformatics. 2003 Jan 22;19(2):185-93.</p></li>
<li><p>Johnson WE, Rabinovic A, and Li C (2007) <em>Adjusting batch effects in
microarray expression data using Empirical Bayes methods</em>
Biostatistics 8(1):118-127.</p></li>
<li><p>Lee JK, Havaleshko DM, Cho H, et al. (2007) <em>A strategy for
predicting the chemosensitivity of human cancers and its application
to drug discovery</em> Proc Natl Acad Sci USA, 2007 Aug 7;
104(32):13086-91. Epub 2007 Jul 31</p></li>
</ol>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../ADRP/README.html" class="btn btn-neutral float-left" title="Pilot1 ADRP Benchmark" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../darts/README.html" class="btn btn-neutral float-right" title="DARTS Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, ANL.gov.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>